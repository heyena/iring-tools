{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "dataTypes": "",
        "models": [
            "AvailItemsModel",
            "TableSelectModel",
            "RelationNameModel",
            "PropertyMapModel",
            "MultiSelect"
        ],
        "stores": [
            "AvailItemsStore",
            "ProviderStore",
            "NHibernateTreeStore",
            "MultiStore",
            "RelatedObjectStore",
            "RelationsStore"
        ],
        "views": [
            "nhibernate.ConnectionStringForm",
            "nhibernate.RelationsForm",
            "nhibernate.SelectTablesForm",
            "nhibernate.MultiSelectionGrid",
            "nhibernate.NhibernatePanel",
            "nhibernate.PropertyGrid",
            "nhibernate.DataObjectForm",
            "nhibernate.DataKeyForm",
            "nhibernate.NhibernateTree",
            "nhibernate.SelectPropertiesForm",
            "nhibernate.SelectDataKeysForm",
            "nhibernate.SetPropertyForm",
            "nhibernate.SetRelationForm",
            "nhibernate.RelationsGrid",
            "nhibernate.MultiSelectComponentGrid"
        ],
        "designer|userClassName": "NHibernate",
        "requires": [
            "AM.view.nhibernate.Utility"
        ]
    },
    "designerId": "732f42fe-9dc6-418c-8ca8-80f24bb50936",
    "customConfigs": [
        {
            "group": "(Custom Properties)",
            "name": "dataTypes",
            "type": "string"
        }
    ],
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onSaveDbObjectTree",
                "implHandler": [
                    "var me = this;\r",
                    "var content = this.getMainContent();\r",
                    "content.body.mask();\r",
                    "var nhPanel = button.up('nhibernatepanel');\r",
                    "\r",
                    "var dbObjectsTree = nhPanel.down('nhibernatetree');\r",
                    "var gridSelected = dbObjectsTree.selectedTables;\r",
                    "var dirNode = me.getDirNode(dbObjectsTree.dirNode);\r",
                    "\r",
                    "if(gridSelected.length === 0) {\r",
                    "  gridSelected = dirNode.data.record.dbInfo.dbTableNames.items;\r",
                    "}\r",
                    "var contextName = dirNode.parentNode.data.text;//dirNode.data.record.context;\r",
                    "var endpoint = dirNode.data.record.Name;//dirNode.data.record.endpoint;\r",
                    "var baseUrl = dirNode.data.record.BaseUrl;\r",
                    "dirNode.data.record.dbInfo.dbProvider = dirNode.data.record.dbDict.Provider;//dbPro;\r",
                    "dirNode.data.record.dbInfo.dbSchema = dirNode.data.record.dbDict.SchemaName//dbSch;\r",
                    "var rootNode = dbObjectsTree.getRootNode();\r",
                    "var treeProperty = me.getJsonTree(rootNode, dirNode, gridSelected);\r",
                    "treeProperty.schemaName= dirNode.data.record.dbDict.SchemaName;//dbSch;\r",
                    "Ext.Ajax.request({\r",
                    "  url: 'AdapterManager/Trees',//'NHibernate/Trees',\r",
                    "  timeout: 600000,\r",
                    "  method: 'POST',\r",
                    "  params: {\r",
                    "    scope: contextName,\r",
                    "    app: endpoint,\r",
                    "    baseUrl: baseUrl,\r",
                    "    tree: Ext.JSON.encode(treeProperty)\r",
                    "  },\r",
                    "  success: function (response, request) {\r",
                    "    var rtext = response.responseText;\r",
                    "    var error = 'SUCCESS = FALSE';\r",
                    "    var index = rtext.toUpperCase().indexOf(error);\r",
                    "    if (index == -1) {\r",
                    "      //showDialog(400, 100, 'Saving Result', 'Configuration has been saved successfully.', Ext.Msg.OK, null);\r",
                    "      var navpanel = me.getDirTree();\r",
                    "      navpanel.onReload(content);\r",
                    "      //content.body.unmask();\r",
                    "    }\r",
                    "    else {\r",
                    "      var msg = rtext.substring(index + error.length + 2, rtext.length - 1);\r",
                    "      showDialog(400, 100, 'Saving Result - Error', msg, Ext.Msg.OK, null);\r",
                    "      content.body.unmask();\r",
                    "    }\r",
                    "  },\r",
                    "  failure: function (response, request) {\r",
                    "    showDialog(660, 300, 'Saving Result', 'An error has occurred while saving the configuration.', Ext.Msg.OK, null);\r",
                    "    content.body.unmask();\r",
                    "  }\r",
                    "});"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "nhibernatepanel button[action=savedbobjectstree]"
            },
            "designerId": "ed7e97c7-10ac-4347-99e7-4aba9898cc76"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onSaveDataObject",
                "implHandler": [
                    "\r",
                    "var me = this; \r",
                    "var form = button.up('dataobjectform');\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var tree = panel.down('nhibernatetree');\r",
                    "var treeNode = tree.getSelectedNode();\r",
                    "var dirNode = me.getDirNode(tree.dirNode);\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "var relationFolderNode;\r",
                    "if (treeNode) {\r",
                    "  var treeNodeProps = treeNode.raw.properties;//treeNode.data.property;\r",
                    "  var objectNameField = form.getForm().findField('objectName');\r",
                    "  var objNam = objectNameField.getValue();\r",
                    "\r",
                    "  if (objectNameField.validate())\r",
                    "  treeNodeProps.objectName = objNam;\r",
                    "  else {\r",
                    "    showDialog(400, 100, 'Warning', \"Object Name is not valid. A valid object name should start with alphabet or \\\"_\\\", and follow by any number of \\\"_\\\", alphabet, or number characters\", Ext.Msg.OK, null);\r",
                    "    return;\r",
                    "  }\r",
                    "\r",
                    "  var oldObjNam = treeNodeProps.objectName;\r",
                    "  treeNodeProps.tableName = form.getForm().findField('tableName').getValue();\r",
                    "  treeNodeProps.objectName = objNam;\r",
                    "  treeNodeProps.keyDelimeter = form.getForm().findField('keyDelimeter').getValue();\r",
                    "  treeNodeProps.description = form.getForm().findField('description').getValue();\r",
                    "\r",
                    "  for (var ijk = 0; ijk < dbDict.dataObjects.length; ijk++) {\r",
                    "    var dataObject = dbDict.dataObjects[ijk];\r",
                    "    if (treeNode.data.text.toUpperCase() != dataObject.objectName.toUpperCase())\r",
                    "    continue;\r",
                    "\r",
                    "    dataObject.objectName = objNam;\r",
                    "    //alert('in loop..desc..'+form.getForm().findField('description').getValue());\r",
                    "    dataObject.description = form.getForm().findField('description').getValue();\r",
                    "    dataObject.keyDelimeter = form.getForm().findField('keyDelimeter').getValue();\r",
                    "  }\r",
                    "\r",
                    "  treeNode.set('text', objNam);\r",
                    "  var rootNode = tree.getRootNode();\r",
                    "\r",
                    "  for (var i = 0; i < rootNode.childNodes.length; i++) {\r",
                    "    var folderNode = rootNode.childNodes[i];\r",
                    "    var folderNodeProp;\r",
                    "    if(folderNode.data.property!=undefined)\r",
                    "    folderNodeProp = folderNode.data.property;\r",
                    "    else\r",
                    "    folderNodeProp = folderNode.raw.properties;\r",
                    "\r",
                    "    if (folderNode.childNodes[2])\r",
                    "    relationFolderNode = folderNode.childNodes[2];\r",
                    "    else\r",
                    "    relationFolderNode = folderNode.attributes.children[2];\r",
                    "\r",
                    "    if (!relationFolderNode)\r",
                    "    continue;\r",
                    "\r",
                    "    if (relationFolderNode.childNodes)\r",
                    "    var relChildenNodes = relationFolderNode.childNodes;\r",
                    "    else\r",
                    "    var relChildenNodes = relationFolderNode.children;\r",
                    "\r",
                    "    if (relChildenNodes) {\r",
                    "      for (var k = 0; k < relChildenNodes.length; k++) {\r",
                    "        var relationNode = relChildenNodes[k];\r",
                    "\r",
                    "        if (relationNode.data.text === '')//if (relationNode.text === '')\r",
                    "        continue;\r",
                    "\r",
                    "        //if (relationNode.data)\r",
                    "        //var relationNodeAttr = relationNode.data\r",
                    "        var relationNodeAttr = relationNode.raw;\r",
                    "        var relObjNam = relationNodeAttr.relatedObjectName;\r",
                    "        if (relObjNam.toLowerCase() != objNam.toLowerCase() && relObjNam.toLowerCase() == oldObjNam.toLowerCase())\r",
                    "        relationNodeAttr.relatedObjectName = objNam;\r",
                    "\r",
                    "        if (relationNodeAttr.relatedObjMap) {\r",
                    "          var relatedObjPropMap = relationNodeAttr.relatedObjMap;\r",
                    "\r",
                    "          for (var iki = 0; iki < relatedObjPropMap.length; iki++) {\r",
                    "            if (relatedObjPropMap[iki].relatedObjName.toLowerCase() == oldObjNam.toLowerCase())\r",
                    "            relatedObjPropMap[iki].relatedObjName = objNam;\r",
                    "          }\r",
                    "        }\r",
                    "      }\r",
                    "    }\r",
                    "  }\r",
                    "}"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "dataobjectform button[action=dataobjectformapply]"
            },
            "designerId": "311cdc39-f7f2-4d6a-bfd5-eb61656dd5ac"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onResetDataObject",
                "implHandler": [
                    "var me = this;\r",
                    "var form = button.up('dataobjectform');\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var tree = panel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(tree.dirNode);\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "var treeNode = tree.getSelectedNode();\r",
                    "var dObject;\r",
                    "Ext.each(dbDict.dataObjects, function (dataObject) {\r",
                    "  //if(dataObject.objectName == treeNode.data.property.objectName)\r",
                    "  if(dataObject.objectName == treeNode.raw.properties.objectName)\r",
                    "  dObject = dataObject;\r",
                    "});\r",
                    "\r",
                    "/*if (treeNode.data.property) {\r",
                    "form.getForm().findField('objectName').setValue(treeNode.data.record.Name);\r",
                    "form.getForm().findField('objectNamespace').setValue(dObject.objectNamespace);\r",
                    "form.getForm().findField('keyDelimiter').setValue(dObject.keyDelimeter);\r",
                    "form.getForm().findField('description').setValue(dObject.description);\r",
                    "}*/\r",
                    "\r",
                    "if (dObject) {\r",
                    "  form.getForm().findField('objectName').setValue(dObject.objectName);\r",
                    "  form.getForm().findField('objectNamespace').setValue(dObject.objectNamespace);\r",
                    "  form.getForm().findField('keyDelimeter').setValue(dObject.keyDelimeter);\r",
                    "  form.getForm().findField('description').setValue(dObject.description);\r",
                    "}\r",
                    "\r",
                    "var nameField = form.getForm().findField('objectName');\r",
                    "var objectName = nameField.getValue();\r",
                    "\r",
                    "/*if (nameField.validate()) {\r",
                    "treeNode.data.property.objectName = objectName;\r",
                    "treeNode.set('text', objectName);\r",
                    "}*/\r",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "dataobjectform button[action=dataobjectformreset]"
            },
            "designerId": "ceb8e6c8-db0e-4c3d-93e0-efe2ba0c854c"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onSaveKeyProperties",
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "var content = this.getMainContent();\r",
                    "var panel = button.up('nhibernatepanel');\r",
                    "var dbObjectsTree = panel.down('nhibernatetree');\r",
                    "var treeStore = dbObjectsTree.getStore();\r",
                    "var treeNode = treeStore.getNodeById(panel.treeNode.internalId);\r",
                    "var rootNode = dbObjectsTree.getRootNode();\r",
                    "var dirNode = me.getDirNode(dbObjectsTree.dirNode);\r",
                    "var form = panel.down('selectdatakeysform');\r",
                    "//var objectGrid =  form.down('multiselectcomponentgrid').items.items[2];//form.down('multiselectiongrid');\r",
                    "//var boundlist = objectGrid.items.items[0].items.items[2].items.items[0].items.items[0];\r",
                    "var selected = form.down('multiselectcomponentgrid').items.items[2].items.items[0].items.items[2].store.data.items;//objectGrid.getSelections(boundlist);//objectGrid.getSelectionModel().getSelection();\r",
                    "var selectValues = [];\r",
                    "Ext.each(selected, function(item) {\r",
                    "  selectValues.push(item.data.text);\r",
                    "});\r",
                    "\r",
                    "var keysNode = panel.treeNode;\r",
                    "var propertiesNode = keysNode.parentNode.childNodes[1];\r",
                    "//var hiddenRootNode = propertiesNode.raw.hiddenNodes.hiddenNode;\r",
                    "\r",
                    "for (var i = 0; i < keysNode.childNodes.length; i++) {\r",
                    "  var found = false;\r",
                    "\r",
                    "  for (var j = 0; j < selectValues.length; j++) {\r",
                    "    if (selectValues[j].toLowerCase() == keysNode.childNodes[i].data.text.toLowerCase()) {\r",
                    "      found = true;\r",
                    "      break;\r",
                    "    }\r",
                    "  }\r",
                    "\r",
                    "  if (!found) {\r",
                    "    if (keysNode.childNodes[i].data.property)\r",
                    "    var properties = keysNode.childNodes[i].data.property;\r",
                    "\r",
                    "    if (properties) {\r",
                    "      delete properties.keyType;\r",
                    "      properties.nullable = false;\r",
                    "      var newKeyNode = {\r",
                    "        text: keysNode.childNodes[i].data.text,//utilsObj.deletedRecords[i].data.text,\r",
                    "        property: properties,//utilsObj.deletedRecords[i].data.property,\r",
                    "        type: \"dataProperty\",\r",
                    "        hidden: false,\r",
                    "        leaf: true,\r",
                    "        iconCls: 'treeProperty'\r",
                    "      };\r",
                    "      keysNode.removeChild(keysNode.childNodes[i], false);\r",
                    "      i--;\r",
                    "    }\r",
                    "    //keysNode.parentNode.childNodes[1].appendChild(keysNode.childNodes[i]);\r",
                    "\r",
                    "    //keysNode.childNodes[i].data.property.nullable = true;\r",
                    "    //delete keysNode.childNodes[i].data.property.keyType;\r",
                    "    panel.treeNode.parentNode.childNodes[1].appendChild(newKeyNode); \r",
                    "\r",
                    "    //panel.treeNode.removeChild(keysNode.childNodes[i], false);\r",
                    "    //i--;\r",
                    "    //break;\r",
                    "  }\r",
                    "}\r",
                    "\r",
                    "var nodeChildren = [];\r",
                    "for (var j = 0; j < keysNode.childNodes.length; j++)\r",
                    "nodeChildren.push(keysNode.childNodes[j].data.text);\r",
                    "\r",
                    "for (var j = 0; j < selectValues.length; j++) {\r",
                    "  var found = false;\r",
                    "  for (var i = 0; i < nodeChildren.length; i++) {\r",
                    "    if (selectValues[j].toLowerCase() == nodeChildren[i].toLowerCase()) {\r",
                    "      found = true;\r",
                    "      break;\r",
                    "    }\r",
                    "  }\r",
                    "  var newKeyNode;\r",
                    "  if (!found) {\r",
                    "\r",
                    "\r",
                    "    for (var jj = 0; jj < propertiesNode.childNodes.length; jj++) {\r",
                    "      //for (var jj = 0; jj < propertiesNode.data.children.length; jj++) {\r",
                    "      if (propertiesNode.childNodes[jj].data.text.toLowerCase() == selectValues[j].toLowerCase()) {\r",
                    "        var properties = propertiesNode.childNodes[jj].data.property;//propertiesNode.data.children[jj].property;\r",
                    "        properties.keyType = 'assigned';\r",
                    "        properties.nullable = false;\r",
                    "        newKeyNode = {\r",
                    "          text: selectValues[j],\r",
                    "          type: \"keyProperty\",\r",
                    "          leaf: true,\r",
                    "          iconCls: 'treeKey',\r",
                    "          hidden: false,\r",
                    "          property: properties\r",
                    "        };\r",
                    "        keysNode.appendChild(newKeyNode);\r",
                    "        var rec;\r",
                    "        for(var k = 0;k<propertiesNode.childNodes.length;k++)\r",
                    "        if(propertiesNode.childNodes[k].data.text == selectValues[j])\r",
                    "        rec = propertiesNode.childNodes[k];\r",
                    "        //propertiesNode.removeChild(propertiesNode.childNodes[jj], false);\r",
                    "        propertiesNode.removeChild(rec, false);\r",
                    "        break;\r",
                    "      }\r",
                    "    }\r",
                    "\r",
                    "    /* for (var kk = 0; kk < hiddenRootNode.children.length; kk++) {\r",
                    "    if (hiddenRootNode.children[kk].text.toLowerCase() == selectValues[j].toLowerCase()) {\r",
                    "    var properties = hiddenRootNode.children[kk].property;\r",
                    "    properties.keyType = 'assigned';\r",
                    "    properties.nullable = false;\r",
                    "    newKeyNode = {\r",
                    "    text: selectValues[j],\r",
                    "    type: \"keyProperty\",\r",
                    "    leaf: true,\r",
                    "    iconCls: 'treeKey',\r",
                    "    hidden: false,\r",
                    "    property: properties\r",
                    "    };\r",
                    "    keysNode.appendChild(newKeyNode);\r",
                    "    hiddenRootNode.children.splice(kk, 1);\r",
                    "    kk--;\r",
                    "    break;\r",
                    "    }\r",
                    "    }\r",
                    "    newKeyNode.dirty = true;*/\r",
                    "  }\r",
                    "}\r",
                    "//Code to remove non select key form key object.\r",
                    "/*var founded;\r",
                    "if(keysNode.childNodes.length > selectValues.length){\r",
                    "for (var j = 0; j < keysNode.childNodes.length; j++){\r",
                    "founded = false;\r",
                    "for (var k = 0; k <selectValues.length ; k++){\r",
                    "if (selectValues[k].toLowerCase() == nodeChildren[j].toLowerCase()) {\r",
                    "founded = true;\r",
                    "break\r",
                    "}\r",
                    "}\r",
                    "if(!founded){\r",
                    "keysNode.removeChild(keysNode.childNodes[j], false);\r",
                    "}\r",
                    "}\r",
                    "\r",
                    "}*/\r",
                    "if (!keysNode.isExpanded())\r",
                    "keysNode.expand();\r",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "selectdatakeysform button[action=saveselectkeys]"
            },
            "designerId": "ab9a24e0-e181-467f-b5dd-ec7956d17474"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onSaveDataProperties",
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "var content = this.getMainContent();\r",
                    "var panel = button.up('nhibernatepanel');\r",
                    "var dbObjectsTree = panel.down('nhibernatetree');\r",
                    "var treeStore = dbObjectsTree.getStore();\r",
                    "var treeNode = treeStore.getNodeById(panel.treeNode.internalId);\r",
                    "var rootNode = dbObjectsTree.getRootNode();\r",
                    "var dirNode = me.getDirNode(dbObjectsTree.dirNode);\r",
                    "var form = panel.down('selectpropertiesform');\r",
                    "//var objectGrid = form.down('multiselectcomponentgrid').items.items[2];//form.down('multiselectiongrid');\r",
                    "//var boundlist = objectGrid.items.items[0].items.items[2].items.items[0].items.items[0];\r",
                    "var selected = form.down('multiselectcomponentgrid').items.items[2].items.items[0].items.items[2].store.data.items;//objectGrid.getSelectionModel().getSelection();\r",
                    "var available = form.down('multiselectcomponentgrid').items.items[2].items.items[0].items.items[0].store.data.items;\r",
                    "var selectValues = [];\r",
                    "Ext.each(selected, function(item) {\r",
                    "  selectValues.push(item.data.text);\r",
                    "});\r",
                    "\r",
                    "var shownProperty = [];\r",
                    "var availItems = [];\r",
                    "//var hiddenRootNode = treeNode.raw.hiddenNodes.hiddenNode;\r",
                    "var hiddenRootNode;\r",
                    "for (var indexOfProperty = 0; indexOfProperty < node.childNodes.length; indexOfProperty++) {\r",
                    "  !me.hasShown(shownProperty, node.childNodes[indexOfProperty].text)\r",
                    "  shownProperty.push(node.childNodes[indexOfProperty].text);\r",
                    "  indexOfProperty++;\r",
                    "}\r",
                    "\r",
                    "var selectedItems = [];\r",
                    "Ext.each(node.childNodes, function (node) {\r",
                    "  selectedItems.push(node.data.text);\r",
                    "});\r",
                    "\r",
                    "/*Ext.each(hiddenRootNode.children, function (node) {\r",
                    "availItems.push(node.text);\r",
                    "});\r",
                    "*/\r",
                    "\r",
                    "//var hiddenRootNode = treeNode.raw.hiddenNodes.hiddenNode;\r",
                    "var hiddenRootNode;\r",
                    "var indexHidden;\r",
                    "\r",
                    "for (var i = 0; i < treeNode.childNodes.length; i++) {\r",
                    "  var found = false;\r",
                    "\r",
                    "  for (var j = 0; j < selectValues.length; j++) {\r",
                    "    if (selectValues[j].toLowerCase() == treeNode.childNodes[i].data.text.toLowerCase()) {\r",
                    "      found = true;\r",
                    "      break;\r",
                    "    }\r",
                    "  }\r",
                    "\r",
                    "  if (!found) {\r",
                    "    utilsObj.deletedRecords.push(treeNode.childNodes[i]);\r",
                    "    treeNode.removeChild(treeNode.childNodes[i], false);\r",
                    "    i--;\r",
                    "  }\r",
                    "}\r",
                    "for (var j = 0; j < selectValues.length; j++) {\r",
                    "  found = false;\r",
                    "\r",
                    "  for (var l = 0; l < treeNode.childNodes.length; l++) {\r",
                    "    if (selectValues[j].toLowerCase() == treeNode.childNodes[l].data.text.toLowerCase()) {\r",
                    "      found = true;\r",
                    "      break;\r",
                    "    }\r",
                    "  }\r",
                    "\r",
                    "  /*for (var k = 0; k < hiddenRootNode.children.length; k++) {\r",
                    "  if (selectValues[j].toLowerCase() == hiddenRootNode.children[k].text.toLowerCase()) {\r",
                    "  indexHidden = k;\r",
                    "  break;\r",
                    "  }\r",
                    "  }*/\r",
                    "  if (!found){\r",
                    "    var propertyToAdd;\r",
                    "    for(var i=0;i<treeNode.data.children.length;i++){\r",
                    "      if(treeNode.data.children[i].text == selectValues[j])\r",
                    "      propertyToAdd = treeNode.data.children[i];\r",
                    "    }\r",
                    "    //if(utilsObj.deletedRecords.length>0){\r",
                    "    /*for (var kk = 0;kk<utilsObj.deletedRecords.length;kk++){\r",
                    "    for (var jj = 0;jj<utilsObj.deletedRecords.length;jj++){\r",
                    "    if(utilsObj.deletedRecords[kk].data.text == utilsObj.deletedRecords[jj].data.text && kk!=jj){\r",
                    "    utilsObj.deletedRecords.splice(jj,1)\r",
                    "    }\r",
                    "    }\r",
                    "    }*/\r",
                    "    // for (var i = 0;i<utilsObj.deletedRecords.length;i++)\r",
                    "    //{\r",
                    "    //if(selectValues[j] == utilsObj.deletedRecords[i].data.text){\r",
                    "    treeNode.appendChild({\r",
                    "      text: propertyToAdd.text,//utilsObj.deletedRecords[i].data.text,\r",
                    "      property: propertyToAdd.property,//utilsObj.deletedRecords[i].data.property,\r",
                    "      type: \"dataProperty\",\r",
                    "      hidden: false,\r",
                    "      leaf: true,\r",
                    "      iconCls: 'treeProperty'\r",
                    "    });\r",
                    "    //}\r",
                    "    //}\r",
                    "    //}\r",
                    "  }\r",
                    "\r",
                    "\r",
                    "  /* if (!found && indexHidden > -1) {\r",
                    "  treeNode.appendChild({\r",
                    "  text: hiddenRootNode.children[indexHidden].text,\r",
                    "  property: hiddenRootNode.children[indexHidden].property,\r",
                    "  type: \"dataProperty\",\r",
                    "  hidden: false,\r",
                    "  leaf: true,\r",
                    "  iconCls: 'treeProperty'\r",
                    "  });\r",
                    "  hiddenRootNode.children.splice(indexHidden, 1);\r",
                    "  }*/\r",
                    "} \r",
                    "if (!treeNode.isExpanded())\r",
                    "treeNode.expand();\r",
                    "\r",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "selectpropertiesform button[action=saveselectproperties]"
            },
            "designerId": "421667fe-28be-4b13-80bf-a4e6f1995612"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onEditDbConnection",
                "implHandler": [
                    "var me = this;\r",
                    "var panel = button.up('nhibernatepanel');\r",
                    "me.showConnectionStringForm(panel);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "nhibernatetree button[action=editdbconnection]"
            },
            "designerId": "a3224a9f-f7c9-4f37-ab64-555ca1312e30"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onResetKeyProperties",
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "var form = button.up('selectdatakeysform');\r",
                    "var grid = form.down('multiselectiongrid');\r",
                    "\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var dataTree = panel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var rootNode = dataTree.getRootNode();\r",
                    "var dataNode = dataTree.getSelectedNode();\r",
                    "var selectKeys = [];\r",
                    "var availTableName = [];\r",
                    "var found = false;\r",
                    "var repeatItem;\r",
                    "\r",
                    "for (var i = 0; i < dataNode.childNodes.length; i++) {\r",
                    "  var keyText = dataNode.childNodes[i].data.text;\r",
                    "  selectKeys.push(keyText);\r",
                    "}\r",
                    "\r",
                    "var itemSelecter = form.down('#multiselectcomponentgrid');\r",
                    "itemSelecter.items.items[2].bindStore(grid.getStore());\r",
                    "if(selectKeys){\r",
                    "  var records = [];\r",
                    "  for(var jj=0;jj<selectKeys.length;jj++){\r",
                    "    for(var  kk = 0;kk<grid.getStore().data.length;kk++){\r",
                    "      if(selectKeys[jj] == grid.getStore().data.items[kk].data.text){\r",
                    "        records.push(grid.getStore().data.items[kk]);\r",
                    "        itemSelecter.items.items[2].items.items[0].items.items[0].getStore().remove(grid.getStore().data.items[kk]);\r",
                    "        break;\r",
                    "      }\r",
                    "    }     \r",
                    "  }\r",
                    "\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[2].getStore().add(records);\r",
                    "}\r",
                    "\r",
                    "\r",
                    "//grid.selectItems(selectTableNamesSingle);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "selectdatakeysform button[action=resetselectkeys]"
            },
            "designerId": "a840d4e0-afcf-4220-bb35-755cf25cb0c5"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onSaveKeyProperty",
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "form = button.up('datakeyform');\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var tree = panel.down('nhibernatetree');\r",
                    "var node = tree.getSelectedNode();\r",
                    "var propertyNameField = form.getForm().findField('propertyName');\r",
                    "var propertyName = propertyNameField.getValue();\r",
                    "var isHidden = form.getForm().findField('isHidden').getValue();\r",
                    "if (propertyNameField.validate()) {\r",
                    "  node.data.property.propertyName = propertyName;\r",
                    "  node.data.property.isHidden = isHidden;\r",
                    "  node.data.property.nullable = form.getForm().findField('isNullable').getValue();\r",
                    "  node.data.property.showOnIndex = form.getForm().findField('showOnIndex').getValue();\r",
                    "  node.raw.properties.propertyName = propertyName;\r",
                    "  node.raw.properties.isHidden = isHidden;\r",
                    "  node.raw.properties.nullable = form.getForm().findField('isNullable').getValue();\r",
                    "  node.raw.properties.showOnIndex = form.getForm().findField('showOnIndex').getValue();\r",
                    "\r",
                    "  node.set('text', propertyName);\r",
                    "}\r",
                    "else {\r",
                    "  showDialog(400, 100, 'Warning', \"Key Property Name is not valid. A valid key property name should start with alphabet or \\\"_\\\", and follow by any number of \\\"_\\\", alphabet, or number characters\", Ext.Msg.OK, null);\r",
                    "}         "
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "button[action=savekeyfield]"
            },
            "designerId": "4bfa6886-5a14-4cc5-85fa-e136dd0591c2"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onResetKeyProperty",
                "implHandler": [
                    "var me = this;\r",
                    "form = button.up('datakeyform');\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var tree = panel.down('nhibernatetree');\r",
                    "var node = tree.getSelectedNode();\r",
                    "var propertyNameField = form.getForm().findField('propertyName');\r",
                    "propertyNameField.setValue(node.data.property.propertyName);\r",
                    "var propertyName = propertyNameField.getValue();\r",
                    "form.getForm().findField('isHidden').setValue(node.data.property.isHidden);\r",
                    "form.getForm().findField('showOnIndex').setValue(node.data.property.showOnIndex);\r",
                    "if (propertyNameField.validate()) {\r",
                    "  node.data.property.propertyName = propertyName;\r",
                    "  node.set('text', propertyName);\r",
                    "}\r",
                    "else {\r",
                    "  showDialog(400, 100, 'Warning', \"Key Property Name is not valid. A valid key property name should start with alphabet or \\\"_\\\", and follow by any number of \\\"_\\\", alphabet, or number characters\", Ext.Msg.OK, null);\r",
                    "} \r",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "datakeyform button[action=resetkeyproperty]"
            },
            "designerId": "b4ae9c45-855a-464e-8527-4c8843722675"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onSaveDataProperty",
                "implHandler": [
                    "var me = this;\r",
                    "form = button.up('setpropertyform');\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var tree = panel.down('nhibernatetree');\r",
                    "var node = tree.getSelectedNode();\r",
                    "var propertyNameField = form.getForm().findField('propertyName');\r",
                    "var isHidden = form.getForm().findField('isHidden').getValue();\r",
                    "var propertyName = propertyNameField.getValue();\r",
                    "if (propertyNameField.validate()) {\r",
                    "  node.data.property.propertyName = propertyName;\r",
                    "  node.data.property.isHidden = isHidden;\r",
                    "  node.data.property.nullable = form.getForm().findField('isNullable').getValue();\r",
                    "  node.data.property.showOnIndex = form.getForm().findField('showOnIndex').getValue();\r",
                    "  node.raw.properties.propertyName = propertyName;\r",
                    "  node.raw.properties.isHidden = isHidden;\r",
                    "  node.raw.properties.nullable = form.getForm().findField('isNullable').getValue();\r",
                    "  node.raw.properties.showOnIndex = form.getForm().findField('showOnIndex').getValue();\r",
                    "\r",
                    "  node.set('text', propertyName);\r",
                    "}\r",
                    "else {\r",
                    "  showDialog(400, 100, 'Warning', \"Property Name is not valid. A valid property name should start with alphabet or \\\"_\\\", and follow by any number of \\\"_\\\", alphabet, or number characters\", Ext.Msg.OK, null);\r",
                    "}         "
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "setpropertyform button[action=savedataproperty]"
            },
            "designerId": "cb53080a-76ca-40dc-831e-6c276816d674"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onResetDataProperty",
                "implHandler": [
                    "var me = this;\r",
                    "form = button.up('setpropertyform');\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var tree = panel.down('nhibernatetree');\r",
                    "\r",
                    "var node = tree.getSelectedNode();\r",
                    "var propertyNameField = form.getForm().findField('propertyName');\r",
                    "propertyNameField.setValue(node.data.property.columnName);\r",
                    "form.getForm().findField('isHidden').setValue(node.data.property.isHidden);\r",
                    "form.getForm().findField('showOnIndex').setValue(node.data.property.showOnIndex);\r",
                    "var propertyName = propertyNameField.getValue();\r",
                    "if (propertyNameField.validate()) {\r",
                    "  node.data.property.propertyName = propertyName;\r",
                    "  node.set('text', propertyName);\r",
                    "}\r",
                    "else {\r",
                    "  showDialog(400, 100, 'Warning', \"Property Name is not valid. A valid property name should start with alphabet or \\\"_\\\", and follow by any number of \\\"_\\\", alphabet, or number characters\", Ext.Msg.OK, null);\r",
                    "} \r",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "setpropertyform button[action=resetdataproperty]"
            },
            "designerId": "8523203d-be36-4ed0-9633-afaa76a23787"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "selectTablesForm",
                "selector": "selecttablesform",
                "xtype": "selecttablesform"
            },
            "designerId": "8bbeb51d-23e6-4aff-a6ff-f6cfc1adf177"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "connectionStringForm",
                "selector": "connectionstringform",
                "xtype": "connectionstringform"
            },
            "designerId": "195135e4-e893-40c4-9e55-579b7f801453"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "dataObjectForm",
                "selector": "dataobjectform",
                "xtype": "dataobjectform"
            },
            "designerId": "e0c2034a-3877-4b2e-8b5a-696bb697e8eb"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "dataKeyForm",
                "selector": "datakeyform",
                "xtype": "datakeyform"
            },
            "designerId": "ab6a81dc-02ae-4595-984a-44303b3599f6"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "selectKeyFieldsForm",
                "selector": "selectdatakeysform",
                "xtype": "selectdatakeysform"
            },
            "designerId": "26a0913a-399b-421f-9a1c-5651f323d72e"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "selectPropertiesForm",
                "selector": "selectpropertiesform",
                "xtype": "selectpropertiesform"
            },
            "designerId": "e7905506-2df6-463a-bf73-35b8995ef35d"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "dataPropertyForm",
                "selector": "setpropertyform",
                "xtype": "setpropertyform"
            },
            "designerId": "9010516a-8609-4f68-a31d-77c73694edaa"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "relationsForm",
                "selector": "relationsform",
                "xtype": "relationsform"
            },
            "designerId": "b8285d88-2ab0-4eaa-8ac3-0ab1e80d1412"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "autoCreate": true,
                "forceCreate": true,
                "ref": "setRelationForm",
                "selector": "setRelationForm",
                "xtype": "setrelationform"
            },
            "designerId": "c43c8869-aac5-46c0-8fa1-dc17b2c940fb"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "dirTree",
                "selector": "viewport > directorypanel > directorytree",
                "xtype": "directorytree"
            },
            "designerId": "a567ac8d-0260-4852-9b38-a7d2efc77d0f"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "mainContent",
                "selector": "viewport > centerpanel > contentpanel",
                "xtype": "contentpanel"
            },
            "designerId": "834c3422-cae6-4615-82af-7d8c35c57bad"
        },
        {
            "type": "applicationaction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onConfignhibernate",
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "var dirTree = me.getDirTree();\r",
                    "dirNode = dirTree.getSelectedNode();\r",
                    "content = me.getMainContent();\r",
                    "//utilsObj.abc = [];\r",
                    "//utilsObj.relationGridDeletedRec =[];\r",
                    "var dbDict, dbInfo, tree;\r",
                    "\r",
                    "var context = dirNode.parentNode.data.text;//dirNode.data.record.ContextName;\r",
                    "var datalayer = dirNode.data.record.DataLayer;\r",
                    "var endpoint = dirNode.data.record.Name;//dirNode.data.record.Endpoint;\r",
                    "var baseUrl = dirNode.data.record.BaseUrl;\r",
                    "var title = 'Nhibernate Configuration - ' + context + '.' + endpoint;\r",
                    "\r",
                    "var panel = content.down('nhibernatepanel[title='+title+']');\r",
                    "\r",
                    "if(!panel) {\r",
                    "  panel = Ext.widget('nhibernatepanel', {\r",
                    "    'title': title\r",
                    "  });  \r",
                    "  //content.add(panel);\r",
                    "\r",
                    "  tree = panel.down('nhibernatetree');\r",
                    "\r",
                    "  tree.dirNode = dirNode.internalId;\r",
                    "  var treeStore = tree.getStore();\r",
                    "  var treeProxy = treeStore.getProxy();\r",
                    "  content.body.mask('Loading...', 'x-mask-loading');\r",
                    "  dbDict = me.getDbDictionary(context, endpoint, baseUrl, function(dbDict) { \r",
                    "    if(dbDict.ConnectionString !== null && dbDict.ConnectionString !=undefined ) {\r",
                    "      var base64 = AM.view.nhibernate.Utility;\r",
                    "      dbDict.ConnectionString = base64.decode(dbDict.ConnectionString);\r",
                    "      if(dbDict) {\r",
                    "        var cstr = dbDict.ConnectionString;\r",
                    "        if(cstr) {\r",
                    "          dirNode.data.record.dbDict = dbDict;\r",
                    "          dbInfo = me.getConnStringParts(cstr, dirNode);\r",
                    "          var selectTableNames = me.setTableNames(dbDict);\r",
                    "\r",
                    "          treeStore.on('beforeload', function (store, action) {\r",
                    "            var params = treeProxy.extraParams;\r",
                    "            params.dbProvider = dbDict.Provider;\r",
                    "            params.dbServer = dbInfo.dbServer;\r",
                    "            params.dbInstance = dbInfo.dbInstance;\r",
                    "            params.dbName = dbInfo.dbName;\r",
                    "            params.dbSchema = dbDict.SchemaName;\r",
                    "            params.dbPassword = dbInfo.dbPassword;\r",
                    "            params.dbUserName = dbInfo.dbUserName;\r",
                    "            params.portNumber = dbInfo.portNumber;\r",
                    "            params.tableNames = selectTableNames;\r",
                    "            params.serName = dbInfo.serName;\r",
                    "            params.scope = context;\r",
                    "            params.app = endpoint;\r",
                    "            params.baseUrl = baseUrl;\r",
                    "          }, me);\r",
                    "\r",
                    "\r",
                    "          /* treeStore.on('afterload', function (treeLoader, node) { \r",
                    "          var rootNode = treeStore.getRootNode();\r",
                    "          me.reloadTree(rootNode, dbDict);\r",
                    "          }, me);*/\r",
                    "\r",
                    "          //treeStore.load();\r",
                    "          treeStore.load({\r",
                    "            callback: function (records, options, success) {\r",
                    "              var rootNode = treeStore.getRootNode();\r",
                    "              content.body.unmask();\r",
                    "              me.reloadTree(rootNode, dbDict);\r",
                    "\r",
                    "            }\r",
                    "          });\r",
                    "\r",
                    "          me.getTableNames(context, endpoint, baseUrl, dirNode);\r",
                    "        }\r",
                    "      }\r",
                    "    } else {\r",
                    "      if (dbInfo !== null && dbInfo !== undefined)\r",
                    "      dirNode.data.record.dbInfo = dbInfo;\r",
                    "\r",
                    "      if (dbDict !== null && dbDict !== undefined)\r",
                    "      dirNode.data.record.dbDict = dbDict;\r",
                    "      me.showConnectionStringForm(panel);\r",
                    "      var rootNode = tree.items.items[0].node;\r",
                    "      if(rootNode.isExpanded())\r",
                    "      rootNode.collapse();\r",
                    "      tree.disable();\r",
                    "\r",
                    "    }\r",
                    "  });\r",
                    "  content.add(panel);\r",
                    "  content.body.unmask();\r",
                    "  //var myTab = content.add(panel);\r",
                    "  //content.setActiveTab(myTab);\r",
                    "}\r",
                    "me.getDataTypes();\r",
                    "content.setActiveTab(panel);"
                ],
                "name": "confignhibernate",
                "scope": "this"
            },
            "designerId": "82baa5f2-a803-456f-8a4b-e6e5a431f42f"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "init",
                "designer|params": [
                    "application"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "me.application.addEvents('confignhibernate');\r",
                    "Ext.QuickTips.init();"
                ]
            },
            "designerId": "abaf4912-6a1c-4fd1-9541-74c897fa76df"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onTreepanelItemClick",
                "implHandler": [
                    "var me = this;\r",
                    "var panel = dataview.up('nhibernatepanel');\r",
                    "var dataNode = record.store.getAt(index);\r",
                    "panel.treeNode = dataNode;\r",
                    "var nodeType = dataNode.data.type.toUpperCase();\r",
                    "if (dataNode.isRoot()) {\r",
                    "  me.showSelectTablesForm(panel);\r",
                    "}\r",
                    "\r",
                    "if (nodeType) {\r",
                    "  switch (nodeType) {\r",
                    "    case 'DATAOBJECT':\r",
                    "    me.showDataObjectForm(panel);\r",
                    "    break;\r",
                    "    case 'KEYS':\r",
                    "    me.showSelectKeyFieldsForm(panel);\r",
                    "    break;\r",
                    "    case 'KEYPROPERTY':\r",
                    "    me.showDataKeyForm(panel);\r",
                    "    break;\r",
                    "    case 'PROPERTIES':\r",
                    "    me.showSelectPropertiesForm(panel);\r",
                    "    break;\r",
                    "    case 'DATAPROPERTY':\r",
                    "    me.showDataPropertyForm(panel);\r",
                    "    break;\r",
                    "    case 'RELATIONSHIPS':\r",
                    "    me.showRelationsForm(panel);\r",
                    "    break;\r",
                    "    case 'RELATIONSHIP':\r",
                    "    me.showSetRelationForm(panel);\r",
                    "    break;\r",
                    "  }\r",
                    "}\r",
                    "\r",
                    ""
                ],
                "name": "itemclick",
                "scope": "me",
                "designer|targetType": "nhibernate.NhibernateTree",
                "designer|controlQuery": "nhibernatetree"
            },
            "designerId": "e55b2200-d766-4630-82b3-5b08d50e9064"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "hasShown",
                "designer|params": [
                    "shownArray",
                    "text"
                ],
                "implHandler": [
                    "for (var shownIndex = 0; shownIndex < shownArray.length; shownIndex++)\r",
                    "if (shownArray[shownIndex] == text)\r",
                    "return true;\r",
                    "return false;"
                ]
            },
            "designerId": "dda5638f-4793-4a30-86da-91060eb6b4bf"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getDbDictionary",
                "designer|params": [
                    "context",
                    "endpoint",
                    "baseUrl",
                    "successCallback"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "var dbDict, dbInfo;\r",
                    "Ext.Ajax.request({\r",
                    "  url: 'AdapterManager/DBDictionary',//'NHibernate/DBDictionary',\r",
                    "  method: 'POST',\r",
                    "  timeout: 6000000,\r",
                    "  params: {\r",
                    "    scope: context,\r",
                    "    app: endpoint,\r",
                    "    baseUrl: baseUrl\r",
                    "  },\r",
                    "  success: function (response, request) {\r",
                    "    dbDict = Ext.JSON.decode(response.responseText);\r",
                    "    successCallback(dbDict);\r",
                    "  },\r",
                    "  failure: function (response, request) {\r",
                    "    //var dataObjPanel = content.items.map[contextName + '.' + endpoint + '.-nh-config'];;\r",
                    "  }\r",
                    "});"
                ]
            },
            "designerId": "8280a8ae-21d9-4e16-b388-4a178353e729"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getTableNames",
                "designer|params": [
                    "context",
                    "endpoint",
                    "baseUrl",
                    "dirNode"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "var dbInfo = dirNode.data.record.dbInfo;\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "\r",
                    "Ext.Ajax.request({\r",
                    "  url: 'AdapterManager/TableNames',\r",
                    "  method: 'POST',\r",
                    "  timeout: 6000000,\r",
                    "  params: {\r",
                    "    scope: context,\r",
                    "    app: endpoint,\r",
                    "    dbProvider: dbDict.Provider,\r",
                    "    dbServer: dbInfo.dbServer,\r",
                    "    dbInstance: dbInfo.dbInstance,\r",
                    "    dbName: dbInfo.dbName,\r",
                    "    dbSchema: dbDict.SchemaName,\r",
                    "    dbUserName: dbInfo.dbUserName,\r",
                    "    dbPassword: dbInfo.dbPassword,\r",
                    "    portNumber: dbInfo.portNumber,\r",
                    "    serName: dbInfo.serName,\r",
                    "    baseUrl: baseUrl\r",
                    "  },\r",
                    "  success: function (response, request) {\r",
                    "    dirNode.data.record.dbInfo.dbTableNames = Ext.JSON.decode(response.responseText);\r",
                    "  },\r",
                    "  failure: function (f, a) {\r",
                    "    if (a.response)\r",
                    "    showDialog(500, 400, 'Error', a.response.responseText, Ext.Msg.OK, null);\r",
                    "  }\r",
                    "});"
                ]
            },
            "designerId": "95192dbc-81f5-4ac7-8b20-ad9be22d9a52"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "setTableNames",
                "designer|params": [
                    "dbDict"
                ],
                "implHandler": [
                    "var selectTableNames = [];\r",
                    "\r",
                    "for (var i = 0; i < dbDict.dataObjects.length; i++) {\r",
                    "  var tableName = (dbDict.dataObjects[i].tableName ? dbDict.dataObjects[i].tableName : dbDict.dataObjects[i]);\r",
                    "  selectTableNames.push(tableName);\r",
                    "}\r",
                    "return selectTableNames;"
                ]
            },
            "designerId": "0573e2fd-252f-4155-b2b4-bd710c3b86c8"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getAvailableItems",
                "designer|params": [
                    "node"
                ],
                "implHandler": [
                    "var availItems = [];\r",
                    "var propertiesNode = node.parentNode.childNodes[1];\r",
                    "\r",
                    "for (var i = 0; i < propertiesNode.childNodes.length; i++) {\r",
                    "  var itemName = propertiesNode.childNodes[i].data.text;//propertiesNode.childNodes[i].text;\r",
                    "  var found = false;\r",
                    "\r",
                    "  for (var j = 0; j < node.childNodes.length; j++) {\r",
                    "    if (node.childNodes[j].data.text.toLowerCase() == itemName.toLowerCase()) {//if (node.childNodes[j].text.toLowerCase() == itemName.toLowerCase()) {\r",
                    "      found = true;\r",
                    "      break;\r",
                    "    }\r",
                    "  }\r",
                    "  //if (!found) {\r",
                    "  availItems.push([itemName, itemName]);\r",
                    "  //}\r",
                    "}\r",
                    "return availItems;"
                ]
            },
            "designerId": "a80490c1-9a7c-4e05-b8ef-4fe23a7a276a"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getSelectedItems",
                "designer|params": [
                    "node"
                ],
                "implHandler": [
                    "var selectedItems = [];\r",
                    "var propertiesNode = node.parentNode.childNodes[1];\r",
                    "\r",
                    "for (var i = 0; i < node.childNodes.length; i++) {\r",
                    "  var keyName = node.childNodes[i].text;\r",
                    "  selectedItems.push([keyName, keyName]);\r",
                    "}\r",
                    "return selectedItems;\r",
                    ""
                ]
            },
            "designerId": "82e893d1-0600-42df-b6ce-6bcf86d2d7d6"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getSelectItems",
                "designer|params": [
                    "node"
                ],
                "implHandler": [
                    "var selectItems = [];\r",
                    "\r",
                    "for (var i = 0; i < node.childNodes.length; i++) {\r",
                    "  var keyName = node.childNodes[i].data.text;\r",
                    "  selectItems.push(keyName);\r",
                    "}\r",
                    "\r",
                    "return selectItems;"
                ]
            },
            "designerId": "24ab7cef-3c85-44fc-be18-2b7c626141b4"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showSelectTablesForm",
                "designer|params": [
                    "nhibernatePanel"
                ],
                "implHandler": [
                    "var me = this, \r",
                    "form = me.getSelectTablesForm();\r",
                    "var dataTree = nhibernatePanel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var selected = [];\r",
                    "var dict = dataTree.getStore().tree.root.childNodes;//dirNode.data.record.dbDict.dataObjects;\r",
                    "Ext.each(dict, function(table) {\r",
                    "  //selected.push(table.data.tableName);\r",
                    "  selected.push(table.data.text);\r",
                    "});\r",
                    "\r",
                    "var tables = dirNode.data.record.dbInfo.dbTableNames.items; \r",
                    "var grid = form.down('#tablesSelectionGrid');\r",
                    "var itemSelecter = form.down('#multiselectcomponentgrid');\r",
                    "\r",
                    "//var tempStore = itemSelecter.items.items[0].getStore();\r",
                    "grid.loadItems(tables);\r",
                    "//var updatedStore = grid.getStore();\r",
                    "for(var i=0;i<tables.length;i++){\r",
                    "  grid.getStore().data.items[i].data.text = tables[i];\r",
                    "  grid.getStore().data.items[i].data.value = tables[i];\r",
                    "}\r",
                    "\r",
                    "itemSelecter.items.items[2].bindStore(grid.getStore());\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(0);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(0);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(3);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(3);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(2);\r",
                    "//grid.down('gridcolumn').setText('Select Data Tables');\r",
                    "grid.selectItems(selected);\r",
                    "//itemSelecter.items.items[1].selectItems(selected);\r",
                    "//var tempStore = itemSelecter.items.items[2].getStore();\r",
                    "if(selected){\r",
                    "\r",
                    "  var records = [];\r",
                    "  utilsObj.deletedTables = [];\r",
                    "  Ext.each(selected, function(item) {\r",
                    "    var record = grid.getStore().findRecord('text', item);\r",
                    "    if(record) {\r",
                    "      records.push(record); \r",
                    "      utilsObj.deletedTables.push(record);\r",
                    "      itemSelecter.items.items[2].items.items[0].items.items[0].getStore().remove(record);\r",
                    "    } \r",
                    "    //tempStore.remove(record);\r",
                    "  });\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[2].getStore().add(utilsObj.deletedTables);\r",
                    "  //itemSelecter.items.items[2].bindStore(tempStore);\r",
                    "}\r",
                    "\r",
                    "panel = nhibernatePanel.down('#nhibernateContent');\r",
                    "\r",
                    "panel.removeAll();\r",
                    "panel.doLayout();\r",
                    "\r",
                    "panel.add(form);\r",
                    "panel.doLayout();\r",
                    "\r",
                    ""
                ]
            },
            "designerId": "9d09026c-708e-447c-801d-f60ea204561e"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showConnectionStringForm",
                "designer|params": [
                    "nhibernatePanel"
                ],
                "implHandler": [
                    "\tvar me = this,\r",
                    "  form = me.getConnectionStringForm();\r",
                    "  var dataTree = nhibernatePanel.down('nhibernatetree');\r",
                    "  var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "  var dbDict = dirNode.data.record.dbDict;\r",
                    "  var dbInfo = dirNode.data.record.dbInfo;\r",
                    "  var combo = form.down('#providerCombo');\r",
                    "\tcombo.on('select', function (combo, record, options) {\r",
                    "      var dbProvider = record[0].data.Provider.toUpperCase();\r",
                    "      var dbName = form.getForm().findField('dbName');\r",
                    "      var portNumber = form.getForm().findField('portNumber');\r",
                    "      var host = form.getForm().findField('host');\r",
                    "      var dbServer = form.getForm().findField('dbServer');\r",
                    "      var dbInstance = form.getForm().findField('dbInstance');\r",
                    "      var serviceName = form.down('#oraclecontainer');\r",
                    "      var dbSchema = form.getForm().findField('dbSchema');\r",
                    "      var userName = form.getForm().findField('dbUserName');\r",
                    "      var password = form.getForm().findField('dbPassword');\r",
                    "      var sid = form.getForm().findField('field_sid');\r",
                    "      var serName = form.getForm().findField('field_serviceName');\r",
                    "\r",
                    "  if (dbProvider.indexOf('ORACLE') > -1) {\r",
                    "    if (dbName.hidden === false) {\r",
                    "      dbName.hide();\r",
                    "      dbServer.hide();\r",
                    "      dbInstance.hide();\r",
                    "    }\r",
                    "\r",
                    "    if (host.hidden === true) {\r",
                    "      if (dbDict.Provider) {\r",
                    "        if (dbDict.Provider.toUpperCase().indexOf('ORACLE') > -1) {\r",
                    "          host.setValue(dbInfo.dbServer);\r",
                    "          sid.setValue(dbInfo.dbInstance);\r",
                    "          serName.setValue(dbInfo.serName);\r",
                    "          serviceName.show();\r",
                    "          host.show();\r",
                    "          userName.setValue(dbInfo.dbUserName);\r",
                    "          password.setValue(dbInfo.dbPassword);\r",
                    "          dbSchema.setValue(dbDict.SchemaName);\r",
                    "        }\r",
                    "        else\r",
                    "        me.resetConfigOracle(host, dbSchema, userName, password, serviceName, sid, serName);\r",
                    "      }\r",
                    "      else\r",
                    "      me.resetConfigOracle(host, dbSchema, userName, password, serviceName, sid, serName);\r",
                    "\r",
                    "      portNumber.setValue('1521');\r",
                    "      portNumber.show();\r",
                    "    }\r",
                    "  }\r",
                    "  else if (dbProvider.indexOf('MSSQL') > -1) {\r",
                    "    if (host.hidden === false) {\r",
                    "      portNumber.hide();\r",
                    "      host.hide();\r",
                    "      sid.clearInvalid();\r",
                    "      sid.disable();\r",
                    "      serName.clearInvalid();\r",
                    "      serName.disable();\r",
                    "      serviceName.hide();\r",
                    "    }\r",
                    "\r",
                    "    if (dbName.hidden === true) {\r",
                    "      if (dbDict.Provider) {\r",
                    "        if (dbDict.Provider.toUpperCase().indexOf('MSSQL') > -1) {\r",
                    "          dbName.setValue(dbInfo.dbName);\r",
                    "          dbServer.setValue(dbInfo.dbServer);\r",
                    "          dbInstance.setValue(dbInfo.dbInstance);\r",
                    "          dbName.show();\r",
                    "          dbServer.show();\r",
                    "          dbInstance.show();\r",
                    "          sid.clearInvalid();\r",
                    "          sid.disable();\r",
                    "          serName.clearInvalid();\r",
                    "          serName.disable();\r",
                    "          dbSchema.setValue(dbDict.SchemaName);\r",
                    "          userName.setValue(dbInfo.dbUserName);\r",
                    "          password.setValue(dbInfo.dbPassword);\r",
                    "        }\r",
                    "        else\r",
                    "        me.resetConfigMsSql(dbName, dbServer, dbInstance, dbSchema, userName, password);\r",
                    "      }\r",
                    "      else\r",
                    "      me.resetConfigMsSql(dbName, dbServer, dbInstance, dbSchema, userName, password);\r",
                    "    }\r",
                    "\r",
                    "    portNumber.setValue('1433');\r",
                    "  }\r",
                    "  else if (dbProvider.indexOf('MYSQL') > -1) {\r",
                    "    if (dbServer.hidden === true) {\r",
                    "      dbServer.setValue('');\r",
                    "      dbServer.clearInvalid();\r",
                    "      dbServer.show();\r",
                    "    }\r",
                    "\r",
                    "    if (host.hidden === false) {\r",
                    "      portNumber.hide();\r",
                    "      host.hide();\r",
                    "      sid.clearInvalid();\r",
                    "      sid.disable();\r",
                    "      serName.clearInvalid();\r",
                    "      serName.disable();\r",
                    "      serviceName.hide();\r",
                    "      portNumber.setValue('3306');\r",
                    "    }\r",
                    "\r",
                    "  }\r",
                    "\r",
                    "}, me);\r",
                    "\r",
                    "var cmbStore = combo.getStore();\r",
                    "var cmbProxy = cmbStore.getProxy();\r",
                    "cmbStore.on('beforeload', function(store, action) {\r",
                    "  cmbProxy.extraParams.baseUrl = node.data.record.BaseUrl;\r",
                    "});\r",
                    "cmbStore.load();\r",
                    "//if(dirNode.data.record.dbInfo!=undefined)\r",
                    "//dirNode.data.record.dbInfo.dbSchema = form.getForm().findField('dbSchema').getValue();\r",
                    "form.setActive(dirNode.data.record.dbInfo);\r",
                    "\r",
                    "panel = nhibernatePanel.down('#nhibernateContent');\r",
                    "panel.removeAll();\r",
                    "panel.doLayout();\r",
                    "panel.add(form);"
                ]
            },
            "designerId": "b2ce807b-c0fd-424f-a32b-a3a71dd4ef62"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showDataObjectForm",
                "designer|params": [
                    "nhibernatePanel"
                ],
                "implHandler": [
                    "var me = this, \r",
                    "form = me.getDataObjectForm();\r",
                    "var keyDelimeter;\r",
                    "var description\r",
                    "var dataTree = nhibernatePanel.down('nhibernatetree');\r",
                    "var treeNode = dataTree.getSelectedNode();\r",
                    "description = treeNode.raw.properties.description ;\r",
                    "keyDelimeter = treeNode.raw.properties.keyDelimeter;\r",
                    "//var tree = panel.down('nhibernatetree');\r",
                    "//var treeNode = tree.getSelectedNode();\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "/*if (!treeNode.data.property || treeNode.data.property.keyDelimiter === 'null' || \r",
                    "!treeNode.data.property.keyDelimiter || treeNode.data.property.keyDelimiter === undefined) {\r",
                    "keyDelimiter = '_';\r",
                    "}   else {\r",
                    "keyDelimiter = treeNode.data.property.keyDelimiter;\r",
                    "}\r",
                    "\r",
                    "form.getForm().findField('tableName').setValue(treeNode.data.property.tableName);\r",
                    "form.getForm().findField('objectNamespace').setValue(treeNode.data.property.objectNamespace);\r",
                    "form.getForm().findField('objectName').setValue(treeNode.data.property.objectName);\r",
                    "form.getForm().findField('keyDelimiter').setValue(keyDelimiter);\r",
                    "*/\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "for (var ijk = 0; ijk < dbDict.dataObjects.length; ijk++) {\r",
                    "  var dataObject = dbDict.dataObjects[ijk];\r",
                    "  if (treeNode.data.text.toUpperCase() != dataObject.objectName.toUpperCase())\r",
                    "  continue;\r",
                    "  description = dataObject.description;\r",
                    "  //description = treeNode.raw.properties.description;\r",
                    "  keyDelimeter = dataObject.keyDelimeter;\r",
                    "  //keyDelimeter = treeNode.raw.properties.keyDelimiter; \r",
                    "}\r",
                    "/*if (treeNode.raw.properties.keyDelimiter === 'null' || \r",
                    "!treeNode.raw.properties.keyDelimiter || treeNode.raw.properties.keyDelimiter === undefined) {\r",
                    "keyDelimiter = '_';\r",
                    "}   else {\r",
                    "keyDelimiter = treeNode.raw.properties.keyDelimiter;\r",
                    "}*/\r",
                    "if (keyDelimeter === 'null' ||!keyDelimeter || keyDelimeter === undefined) \r",
                    "keyDelimeter = '_';\r",
                    "\r",
                    "\r",
                    "form.getForm().findField('tableName').setValue(treeNode.raw.text);\r",
                    "form.getForm().findField('objectNamespace').setValue(treeNode.raw.properties.objectNamespace);\r",
                    "form.getForm().findField('objectName').setValue(treeNode.raw.properties.objectName);\r",
                    "form.getForm().findField('keyDelimeter').setValue(keyDelimeter);\r",
                    "form.getForm().findField('description').setValue(description);\r",
                    "\r",
                    "panel = nhibernatePanel.down('#nhibernateContent');\r",
                    "panel.removeAll();\r",
                    "\r",
                    "panel.add(form);\r",
                    "panel.doLayout();"
                ]
            },
            "designerId": "36145a37-131d-4a5b-a762-ee0abc8f8ead"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showRelationsForm",
                "designer|params": [
                    "nhibernatePanel"
                ],
                "implHandler": [
                    "var me = this, \r",
                    "form = me.getRelationsForm();\r",
                    "var grid = form.down('relationsgrid');\r",
                    "\r",
                    "var gridStore = grid.getStore();\r",
                    "gridStore.removeAll();\r",
                    "var dataTree = nhibernatePanel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var treeNode = dataTree.getSelectionModel().getSelection()[0];\r",
                    "\r",
                    "var context = dirNode.data.property.Context;\r",
                    "var endpoint = dirNode.data.property.Name;\r",
                    "\r",
                    "grid.endpoint = form.endpoint = endpoint;\r",
                    "grid.context = form.context = context;\r",
                    "grid.node = form.node = treeNode;\r",
                    "grid.rootNode = form.rootNode = dataTree.getRootNode();\r",
                    "\r",
                    "treeNode.eachChild(function(n) {\r",
                    "  gridStore.add({'relationName': n.data.text});\r",
                    "});\r",
                    "\r",
                    "panel = nhibernatePanel.down('#nhibernateContent');\r",
                    "\r",
                    "panel.removeAll();\r",
                    "\r",
                    "panel.add(form);\r",
                    "panel.doLayout();\r",
                    "//Ext.getBody().unmask();"
                ]
            },
            "designerId": "1663ffc9-1ed4-4b58-b835-44cf663e8664"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showSetRelationForm",
                "designer|params": [
                    "nhibernatepanel"
                ],
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "var panel = nhibernatepanel.down('#nhibernateContent');\r",
                    "var dataTree = nhibernatepanel.down('nhibernatetree');\r",
                    "var dataNode = dataTree.getSelectedNode();\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var relationFolderNode, \r",
                    "contextName, \r",
                    "endpoint, \r",
                    "rootNode, \r",
                    "relationName;\r",
                    "\r",
                    "rootNode = dataTree.getRootNode();\r",
                    "endpoint = dirNode.data.text;//dirNode.data.record.endpoint;\r",
                    "contextName = dirNode.parentNode.data.text;//dirNode.data.record.context;\r",
                    "\r",
                    "if(dataNode.data.type =='relationships') {\r",
                    "  relationFolderNode = dataNode;\r",
                    "  if(dataNode.firstChild)\r",
                    "  relationName = dataNode.firstChild.data.text;\r",
                    "} else {\r",
                    "  relationFolderNode = dataNode.parentNode;\r",
                    "  relationName = dataNode.data.text;\r",
                    "}\r",
                    "\r",
                    "var dataObjectNode = relationFolderNode.parentNode;\r",
                    "var relatedObjects = [];\r",
                    "var thisObj = dataObjectNode.data.text;\r",
                    "\r",
                    "rootNode.eachChild(function(child) {\r",
                    "  if(child.data.text != thisObj) {\r",
                    "    relatedObjects.push([child.data.text, child.data.text,  child.data.text]); \r",
                    "    // relatedObjects.push([child.data.text, child.data.text, child.data.property.tableName]);\r",
                    "  }\r",
                    "});\r",
                    "\r",
                    "var relatedObjectName = relationFolderNode.childNodes[0].raw.relatedObjectName;\r",
                    "var relatedObject;\r",
                    "rootNode.eachChild(function(child) {\r",
                    "  if(child.data.text == relatedObjectName) {\r",
                    "    relatedObject = child; \r",
                    "  }\r",
                    "});\r",
                    "var relatedObjectPropertyNodes = [];\r",
                    "if(relatedObject!=undefined && relatedObject.childNodes[0]!=undefined && relatedObject.childNodes[1]!=undefined){\r",
                    "  relatedObject.childNodes[0].eachChild(function(child) {\r",
                    "    relatedObjectPropertyNodes.push([child.data.text, child.data.text, child.data.property.columnName]);\r",
                    "  });\r",
                    "  relatedObject.childNodes[1].eachChild(function(child) {\r",
                    "    relatedObjectPropertyNodes.push([child.data.text, child.data.text, child.data.property.columnName]);\r",
                    "  });\r",
                    "\r",
                    "}\r",
                    "\r",
                    "\r",
                    "var keysNode = dataObjectNode.childNodes[0];\r",
                    "var propertiesNode = dataObjectNode.childNodes[1];\r",
                    "\r",
                    "var propertyNodes = [];\r",
                    "keysNode.eachChild(function(child) {\r",
                    "  propertyNodes.push([child.data.text, child.data.text, child.data.property.columnName]);\r",
                    "});\r",
                    "\r",
                    "propertiesNode.eachChild(function(child) {\r",
                    "  propertyNodes.push([child.data.text, child.data.text, child.data.property.columnName]);\r",
                    "});\r",
                    "\r",
                    "\r",
                    "var form = me.getSetRelationForm();\r",
                    "var grid = form.down('relationPropertyGrid');\r",
                    "var gridStore;\r",
                    "gridStore = grid.getStore();\r",
                    "\r",
                    "var propertyNameCmb = form.down('#propertyNameCmb');\r",
                    "propertyNameCmb.store =  Ext.create('Ext.data.SimpleStore', {\r",
                    "  fields: ['value', 'text', 'name'],\r",
                    "  autoLoad: true,\r",
                    "  data: propertyNodes\r",
                    "});\r",
                    "\r",
                    "propertyNameCmb.valueField = 'text';\r",
                    "\r",
                    "var relatedObjectCombo = form.down('#relatedObjectCmb');\r",
                    "relatedObjectCombo.store = Ext.create('Ext.data.SimpleStore', {\r",
                    "  fields: ['value', 'text'],\r",
                    "  autoLoad: true,\r",
                    "  data: relatedObjects\r",
                    "});\r",
                    "\r",
                    "relatedObjectCombo.valueField = 'value';\r",
                    "\r",
                    "var mapPropertyNameCmb = form.down('#mapPropertyNameCmb');\r",
                    "mapPropertyNameCmb.store = Ext.create('Ext.data.SimpleStore', {\r",
                    "  fields: ['value', 'text', 'name'],\r",
                    "  autoLoad: true,\r",
                    "  data: relatedObjectPropertyNodes\r",
                    "});\r",
                    "mapPropertyNameCmb.valueField = 'text';\r",
                    "\r",
                    "form.endpoint = endpoint;\r",
                    "form.contextName = contextName;\r",
                    "form.rootNode = rootNode;\r",
                    "form.node = relationFolderNode;\r",
                    "\r",
                    "relationFolderNode.eachChild(function(relation) {\r",
                    "  if(relation.data.text == relationName) {\r",
                    "    var data;\r",
                    "    if(relation.data.relationshipType)\r",
                    "    data = relation.data;\r",
                    "    else\r",
                    "    data = relation.raw;\r",
                    "    var pMap;\r",
                    "    if(data.propertyMap) {\r",
                    "      gridStore.removeAll();\r",
                    "      for(var i=0;i<data.propertyMap.length;i++){\r",
                    "        pMap = data.propertyMap[i];\r",
                    "        if(pMap){\r",
                    "\r",
                    "          var record = [{\r",
                    "            'property':  pMap.dataPropertyName,\r",
                    "            'relatedProperty': pMap.relatedPropertyName\r",
                    "          }];\r",
                    "          var exist = gridStore.find('property', pMap.dataPropertyName);\r",
                    "          if(exist == -1)\r",
                    "          gridStore.add(record);\r",
                    "\r",
                    "        }\r",
                    "      }\r",
                    "\r",
                    "    }else\r",
                    "    gridStore.removeAll();\r",
                    "\r",
                    "    form.getForm().findField('relationType').setValue(data.relationshipType);\r",
                    "    //form.getForm().findField('relatedObjectName').setValue(data.relatedObjectName);\r",
                    "  }\r",
                    "});\r",
                    "\r",
                    "\r",
                    "form.getForm().findField('relationshipName').setValue(relationName);\r",
                    "form.getForm().findField('objectName').setValue(thisObj);\r",
                    "if(utilsObj.parentNode!=null && utilsObj.parentNode!=dataNode.parentNode.parentNode.data.text){\r",
                    "  utilsObj.relationGridStore = [];\r",
                    "  utilsObj.parentNode = dataNode.parentNode.parentNode.data.text;\r",
                    "}\r",
                    "if(utilsObj.relationGridStore.length == 0){\r",
                    "  utilsObj.parentNode = dataNode.parentNode.parentNode.data.text;\r",
                    "  gridStore.each(function(record) {\r",
                    "    utilsObj.relationGridStore.push({'dataPropertyName': record.data.property, 'relatedPropertyName': record.data.relatedProperty});\r",
                    "  });\r",
                    "}\r",
                    "panel.removeAll();\r",
                    "panel.add(form);\r",
                    "panel.doLayout();"
                ]
            },
            "designerId": "dbdfd728-a2ce-4681-bd9a-e37007361f1c"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getConnStringParts",
                "designer|params": [
                    "connString",
                    "dirNode"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "var dsValue, serName;\r",
                    "var connStrParts = connString.split(';');\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "var provider = dbDict.Provider.toUpperCase();\r",
                    "\r",
                    "if (dirNode.data.record.dbInfo === undefined) {\r",
                    "  dirNode.data.record.dbInfo = {};\r",
                    "}\r",
                    "\r",
                    "if (!dirNode.data.record.dbInfo.dbUserName)\r",
                    "dirNode.data.record.dbInfo.dbName = dbDict.SchemaName;\r",
                    "\r",
                    "for (var i = 0; i < connStrParts.length; i++) {\r",
                    "  var pair = connStrParts[i].split('=');\r",
                    "  switch (pair[0].toUpperCase()) {\r",
                    "    case 'DATA SOURCE':\r",
                    "    if (provider.indexOf('MSSQL') > -1) {\r",
                    "      dsValue = pair[1].split('\\\\');\r",
                    "      dirNode.data.record.dbInfo.dbServer = (dsValue[0].toLowerCase() == '.' ? 'localhost' : dsValue[0]);\r",
                    "      dirNode.data.record.dbInfo.dbInstance = dsValue[1];\r",
                    "      dirNode.data.record.dbInfo.portNumber = 1433;\r",
                    "      dirNode.data.record.dbInfo.serName = '';\r",
                    "    }\r",
                    "    else if (provider.indexOf('MYSQL') > -1) {\r",
                    "      dirNode.data.record.dbInfo.dbServer = (pair[1].toLowerCase() == '.' ? 'localhost' : pair[1]);\r",
                    "      dirNode.data.record.dbInfo.portNumber = 3306;\r",
                    "    }\r",
                    "    else if (provider.indexOf('ORACLE') > -1) {\r",
                    "      var dsStr = connStrParts[i].substring(12, connStrParts[i].length);\r",
                    "      dsValue = dsStr.split('=');\r",
                    "      for (var j = 0; j < dsValue.length; j++) {\r",
                    "        dsValue[j] = dsValue[j].substring(dsValue[j].indexOf('(') + 1, dsValue[j].length);\r",
                    "        switch (dsValue[j].toUpperCase()) {\r",
                    "          case 'HOST':\r",
                    "          var server = dsValue[j + 1];\r",
                    "          var port = dsValue[j + 2];\r",
                    "          var index = server.indexOf(')');\r",
                    "          server = server.substring(0, index);\r",
                    "          dirNode.data.record.dbInfo.portNumber = port.substring(0, 4);\r",
                    "          dirNode.data.record.dbInfo.dbServer = (server.toLowerCase() == '.' ? 'localhost' : server);\r",
                    "          break;\r",
                    "          case 'SERVICE_NAME':\r",
                    "          serName = dsValue[j + 1];\r",
                    "          index = sername.indexOf(')');\r",
                    "          dirNode.data.record.dbInfo.dbInstance = serName.substring(0, index);\r",
                    "          dirNode.data.record.dbInfo.serName = 'SERVICE_NAME';\r",
                    "          break;\r",
                    "          case 'SID':\r",
                    "          serName = dsValue[j + 1];\r",
                    "          index = sername.indexOf(')');\r",
                    "          dirNode.data.record.dbInfo.dbInstance = serName.substring(0, index);\r",
                    "          dirNode.data.record.dbInfo.serName = 'SID';\r",
                    "          break;\r",
                    "        }\r",
                    "      }\r",
                    "    }\r",
                    "    break;\r",
                    "    case 'INITIAL CATALOG':\r",
                    "    dirNode.data.record.dbInfo.dbName = pair[1];\r",
                    "    break;\r",
                    "    case 'USER ID':\r",
                    "    dirNode.data.record.dbInfo.dbUserName = pair[1];\r",
                    "    break;\r",
                    "    case 'PASSWORD':\r",
                    "    dirNode.data.record.dbInfo.dbPassword = pair[1];\r",
                    "    break;\r",
                    "  }\r",
                    "}\r",
                    "return dirNode.data.record.dbInfo;"
                ]
            },
            "designerId": "e6408b80-6349-457d-8324-fe89ff39f707"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showSelectKeyFieldsForm",
                "designer|params": [
                    "nhibernatePanel"
                ],
                "implHandler": [
                    "\r",
                    "var me = this, \r",
                    "form = me.getSelectKeyFieldsForm();\r",
                    "var selected = [];\r",
                    "var dataTree = nhibernatePanel.down('nhibernatetree');\r",
                    "var dataNode = dataTree.getSelectedNode();\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var context =dirNode.parentNode.data.text;//dirNode.data.record.context;\r",
                    "var endpoint = dirNode.data.record.Name;//dirNode.data.record.endpoint;\r",
                    "var baseUrl = dirNode.data.record.baseUrl;\r",
                    "\r",
                    "var grid = form.down('#multiSelectDataKeys');\r",
                    "grid.down('gridcolumn').setText('Select Key Properties');\r",
                    "var itemSelecter = form.down('#multiselectcomponentgrid');\r",
                    "var availItems = [];\r",
                    "var propertiesNode = dataNode.parentNode.childNodes[1];\r",
                    "//var hiddenRootNode = propertiesNode.raw.hiddenNodes.hiddenNode;\r",
                    "\r",
                    "var selectItems = me.getSelectItems(dataNode);\r",
                    "Ext.each(selectItems, function (item) {\r",
                    "  availItems.push(item);\r",
                    "});\r",
                    "\r",
                    "/*Ext.each(hiddenRootNode.children, function(node) {\r",
                    "availItems.push(node.text);\r",
                    "});*/\r",
                    "var availKeys = [];\r",
                    "for (var i = 0; i < propertiesNode.data.children.length; i++) {\r",
                    "  var itemName = propertiesNode.data.children[i].text;//propertiesNode.childNodes[i].text;\r",
                    "  var found = false;\r",
                    "\r",
                    "  for (var j = 0; j < propertiesNode.childNodes.length; j++) {\r",
                    "    if (propertiesNode.childNodes[j].data.text.toLowerCase() == itemName.toLowerCase()) {//if (node.childNodes[j].text.toLowerCase() == itemName.toLowerCase()) {\r",
                    "      found = true;\r",
                    "      break;\r",
                    "    }\r",
                    "  }\r",
                    "  if (!found) {\r",
                    "    if(selectItems.indexOf(itemName) == -1){\r",
                    "      availKeys.push([itemName, itemName]);\r",
                    "    }\r",
                    "  }\r",
                    "}\r",
                    "var availableItem = me.getAvailableItems(dataNode);\r",
                    "/*for(l = 0;l<availKeys.length;l++){\r",
                    "availableItem.push(availKeys[l]);\r",
                    "}*/\r",
                    "\r",
                    "for(l = 0;l<availKeys.length;l++){\r",
                    "  var keyFlag = true;\r",
                    "  for(k = 0;k<availableItem.length;k++){\r",
                    "    if(availKeys[l][0] == selectItems[j])//availableItem[k][0])\r",
                    "    keyFlag = false;\r",
                    "  }\r",
                    "  if(keyFlag)\r",
                    "  availableItem.push(availKeys[l]);\r",
                    "}\r",
                    "Ext.each(availableItem, function(node) {\r",
                    "  availItems.push(node[0]);\r",
                    "})\r",
                    "grid.loadItems(availItems);\r",
                    "//grid.selectItems(selectItems);\r",
                    "for(var i=0;i<availItems.length;i++){\r",
                    "  grid.getStore().data.items[i].data.text = availItems[i];\r",
                    "  grid.getStore().data.items[i].data.value = availItems[i];\r",
                    "}\r",
                    "itemSelecter.items.items[2].bindStore(grid.getStore());\r",
                    "itemSelecter.items.items[0].setText('Available Keys');\r",
                    "itemSelecter.items.items[1].setText('Selected Keys');\r",
                    "itemSelecter.items.items[1].margin = '0 0 0 153';\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(0);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(0);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(3);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(3);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(2);\r",
                    "\r",
                    "//itemSelecter.items.items[2].items.items[0].items.items[2].bindStore(grid.getStore());\r",
                    "if(selectItems){\r",
                    "  utilsObj.deletedKeyProperties = [];\r",
                    "  var records = [];\r",
                    "  /*Ext.each(selectItems, function(item) {\r",
                    "  var record = grid.getStore().findRecord('text', item);\r",
                    "  if(record) {\r",
                    "  records.push(record);\r",
                    "  utilsObj.deletedKeyProperties.push(record);\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[0].getStore().remove(record);\r",
                    "  } \r",
                    "\r",
                    "  });*/\r",
                    "  for(var jj=0;jj<selectItems.length;jj++){\r",
                    "    for(var  kk = 0;kk<grid.getStore().data.length;kk++){\r",
                    "      if(selectItems[jj] == grid.getStore().data.items[kk].data.text){\r",
                    "        //records.push(record);\r",
                    "        utilsObj.deletedKeyProperties.push(grid.getStore().data.items[kk]);\r",
                    "        itemSelecter.items.items[2].items.items[0].items.items[0].getStore().remove(grid.getStore().data.items[kk]);\r",
                    "        break;\r",
                    "      }\r",
                    "    }     \r",
                    "  }\r",
                    "\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[2].getStore().add(utilsObj.deletedKeyProperties);\r",
                    "}\r",
                    "\r",
                    "panel = nhibernatePanel.down('#nhibernateContent');\r",
                    "\r",
                    "panel.removeAll();\r",
                    "\r",
                    "panel.add(form);\r",
                    "panel.doLayout();\r",
                    "\r",
                    "Ext.getBody().unmask();\r",
                    "\r",
                    ""
                ]
            },
            "designerId": "310028c2-5cbf-4882-82de-d0be3b467c45"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showSelectPropertiesForm",
                "designer|params": [
                    "nhibernatePanel"
                ],
                "implHandler": [
                    "\r",
                    "var me = this, \r",
                    "form = me.getSelectPropertiesForm();\r",
                    "var selected = [];\r",
                    "var dataTree = nhibernatePanel.down('nhibernatetree');\r",
                    "var dataNode = dataTree.getSelectedNode();\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var context = dirNode.data.record.context;\r",
                    "var endpoint = dirNode.data.record.endpoint;\r",
                    "var baseUrl = dirNode.data.record.baseUrl;\r",
                    "\r",
                    "var grid = form.down('#propertiesSelectionGrid');\r",
                    "grid.down('gridcolumn').setText('Select Data Properties');\r",
                    "\r",
                    "var availItems = [];\r",
                    "var propertiesNode = dataNode.parentNode.childNodes[1];\r",
                    "//var hiddenRootNode = propertiesNode.raw.hiddenNodes.hiddenNode;\r",
                    "var availProperties = [];\r",
                    "var selectItems = me.getSelectItems(dataNode);\r",
                    "var availableItems = me.getAvailableItems(dataNode);//me.getAvailableItems(utilsObj.availableDataProperties);//\r",
                    "Ext.each(selectItems, function (item) {\r",
                    "  availItems.push(item);\r",
                    "});\r",
                    "\r",
                    "for (var i = 0; i < propertiesNode.data.children.length; i++) {\r",
                    "  var itemName = propertiesNode.data.children[i].text;//propertiesNode.childNodes[i].text;\r",
                    "  var found = false;\r",
                    "\r",
                    "  for (var j = 0; j < propertiesNode.childNodes.length; j++) {\r",
                    "    if (propertiesNode.childNodes[j].data.text.toLowerCase() == itemName.toLowerCase()) {//if (node.childNodes[j].text.toLowerCase() == itemName.toLowerCase()) {\r",
                    "      found = true;\r",
                    "      break;\r",
                    "    }\r",
                    "  }\r",
                    "  if (!found) {\r",
                    "    var flag = true;\r",
                    "    for(var k = 0;k<propertiesNode.parentNode.childNodes[0].childNodes.length;k++){\r",
                    "      if(propertiesNode.parentNode.childNodes[0].childNodes[k].data.text == itemName)\r",
                    "      flag = false;\r",
                    "    }\r",
                    "    if(flag)\r",
                    "    availProperties.push([itemName, itemName]);\r",
                    "  }\r",
                    "}\r",
                    "\r",
                    "/*\r",
                    "Ext.each(hiddenRootNode.children, function(node) {\r",
                    "availItems.push(node.text);\r",
                    "});\r",
                    "*/\r",
                    "\r",
                    "/*Ext.each(availableItems, function(node) {\r",
                    "availItems.push(node[0]);\r",
                    "});*/\r",
                    "\r",
                    "grid.loadItems(availItems);\r",
                    "//grid.selectItems(selectItems);\r",
                    "var itemSelecter = form.down('#multiselectcomponentgrid');\r",
                    "for(var i=0;i<availItems.length;i++){\r",
                    "  grid.getStore().data.items[i].data.text = availItems[i];\r",
                    "  grid.getStore().data.items[i].data.value = availItems[i];\r",
                    "}\r",
                    "/*var index;\r",
                    "for(j=0;j<selectItems.length;j++){\r",
                    "index = grid.store.find('text',selectItems[j]);\r",
                    "utilsObj.deletedDataProperties = grid.store.getAt(index);\r",
                    "grid.store.removeAt(index);\r",
                    "}*/\r",
                    "var blankStore = Ext.create('AM.store.MultiStore');\r",
                    "blankStore.add(availProperties);\r",
                    "itemSelecter.items.items[2].bindStore(blankStore);\r",
                    "itemSelecter.items.items[2].items.items[0].items.items[2].bindStore(grid.getStore());\r",
                    "itemSelecter.items.items[0].setText('Available Properties');\r",
                    "itemSelecter.items.items[1].setText('Selected Properties');\r",
                    "itemSelecter.items.items[1].margin = '0 0 0 120';\r",
                    "\r",
                    "\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(0);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(0);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(3);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(3);\r",
                    "buttons = itemSelecter.items.items[2].items.items[0].items.items[1].items.removeAt(2);\r",
                    "panel = nhibernatePanel.down('#nhibernateContent');\r",
                    "\r",
                    "panel.removeAll();\r",
                    "\r",
                    "panel.add(form);\r",
                    "panel.doLayout();\r",
                    "\r",
                    "Ext.getBody().unmask();"
                ]
            },
            "designerId": "75f3cc35-c72f-42bd-9652-89c691aae788"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showDataKeyForm",
                "designer|params": [
                    "nhibernatePanel"
                ],
                "implHandler": [
                    "\r",
                    "var me = this, \r",
                    "form = me.getDataKeyForm();\r",
                    "\r",
                    "var dataTree = nhibernatePanel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var treeNode = nhibernatePanel.treeNode;\r",
                    "\r",
                    "form.setActiveRecord(treeNode.data.property);\r",
                    "var property = treeNode.data.property;\r",
                    "if (property.showOnIndex.toString().toLowerCase() == 'true') {\r",
                    "  form.getForm().findField('showOnIndex').setValue(true);\r",
                    "}\r",
                    "else {\r",
                    "  form.getForm().findField('showOnIndex').setValue(false);\r",
                    "}\r",
                    "\r",
                    "if (property.nullable.toString().toLowerCase() == 'true') {\r",
                    "  form.getForm().findField('isNullable').setValue(true);\r",
                    "}\r",
                    "else {\r",
                    "  form.getForm().findField('isNullable').setValue(false);\r",
                    "}\r",
                    "panel = nhibernatePanel.down('#nhibernateContent');\r",
                    "\r",
                    "panel.removeAll();\r",
                    "\r",
                    "panel.add(form);\r",
                    "panel.doLayout();\r",
                    "\r",
                    "Ext.getBody().unmask();"
                ]
            },
            "designerId": "74077bb2-8e49-45e8-a8ad-a44d705325d4"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getDirNode",
                "designer|params": [
                    "nodeInternalId"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "var dirTree = me.getDirTree();\r",
                    "var treeStore = dirTree.getStore();\r",
                    "return treeStore.getNodeById(nodeInternalId);\r",
                    "//Returning slectd Node of dirTree\r",
                    "\r",
                    "/*var rootChilds = treeStore.tree.root.childNodes;\r",
                    "if(rootChilds.length>0){\r",
                    "for(var i=0;i<rootChilds.length;i++){\r",
                    "if(rootChilds[i].data.text = 'RijTest'){\r",
                    "var appChild = rootChilds[i];\r",
                    "if(appChild.childNodes.length>0){\r",
                    "for(var j=0;j<appChild.childNodes.length;j++){\r",
                    "if(appChild.childNodes[j].data.text = 'RijTest222')\r",
                    "return appChild.childNodes[j];\r",
                    "}\r",
                    "}\r",
                    "}\r",
                    "}\r",
                    "}*/"
                ]
            },
            "designerId": "4cc338da-158a-47fd-bcb0-bf4fdcfb6593"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showDataPropertyForm",
                "designer|params": [
                    "nhibernatePanel"
                ],
                "implHandler": [
                    "\r",
                    "var me = this, \r",
                    "form = me.getDataPropertyForm();\r",
                    "\r",
                    "var dataTree = nhibernatePanel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var treeNode = nhibernatePanel.treeNode;\r",
                    "\r",
                    "form.setActiveRecord(treeNode.data.property);\r",
                    "var property = treeNode.data.property;\r",
                    "if (property.showOnIndex.toString().toLowerCase() == 'true') {\r",
                    "\t\t\tform.getForm().findField('showOnIndex').setValue(true);\r",
                    "\t }\r",
                    "\t else {\r",
                    "\t\t\t\t\tform.getForm().findField('showOnIndex').setValue(false);\r",
                    "        }\r",
                    "\r",
                    "if (property.nullable.toString().toLowerCase() == 'true') {\r",
                    "\t\t\t\tform.getForm().findField('isNullable').setValue(true);\r",
                    "\t\t\t}\r",
                    "\t\t\telse {\r",
                    "\t\t\t\tform.getForm().findField('isNullable').setValue(false);\r",
                    "\t\t\t}\r",
                    "\r",
                    "panel = nhibernatePanel.down('#nhibernateContent');\r",
                    "\r",
                    "panel.removeAll();\r",
                    "\r",
                    "panel.add(form);\r",
                    "panel.doLayout();\r",
                    "\r",
                    "Ext.getBody().unmask();"
                ]
            },
            "designerId": "e9b65513-4689-4265-8561-042d743fe9f5"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getJsonTree",
                "designer|params": [
                    "rootNode",
                    "dirNode",
                    "selectedTables"
                ],
                "implHandler": [
                    "var me = this; \r",
                    "var treeProperty = {};\r",
                    "treeProperty.dataObjects = [];\r",
                    "treeProperty.IdentityConfiguration = null;\r",
                    "var dbInfo = dirNode.data.record.dbInfo;\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "var tProp = me.setTreeProperty(dbInfo, dbDict, selectedTables);\r",
                    "treeProperty.connectionString = tProp.connectionString;\r",
                    "if (treeProperty.connectionString !== null && treeProperty.connectionString.length > 0) {\r",
                    "  var base64 = AM.view.nhibernate.Utility;\r",
                    "  treeProperty.connectionString = base64.encode(tProp.connectionString);\r",
                    "}\r",
                    "treeProperty.schemaName = tProp.schemaName;\r",
                    "treeProperty.provider = tProp.provider;\r",
                    "treeProperty.enableSummary = tProp.enableSummary;\r",
                    "\r",
                    "var keyName;\r",
                    "for (var i = 0; i < rootNode.childNodes.length; i++) {\r",
                    "  var folder = me.getFolderFromChildNode(rootNode.childNodes[i],dbDict.dataObjects[i]);\r",
                    "  treeProperty.dataObjects.push(folder);\r",
                    "}\r",
                    "\r",
                    "/*for (var i = 0; i < dbDict.dataObjects.length; i++) {\r",
                    "var folder = me.getFolderFromChildNode(dbDict.dataObjects[i]);\r",
                    "treeProperty.dataObjects.push(folder);\r",
                    "}*/\r",
                    "\r",
                    "dbDict.ConnectionString = treeProperty.connectionString;\r",
                    "dbDict.SchemaName = treeProperty.schemaName;\r",
                    "dbDict.Provider = treeProperty.provider;\r",
                    "dbDict.dataObjects = treeProperty.dataObjects;\r",
                    "dbDict.enableSummary = treeProperty.enableSummary;\r",
                    "return treeProperty;"
                ]
            },
            "designerId": "97b4c271-7d5f-4adc-89e0-79d79045f280"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "setTreeProperty",
                "designer|params": [
                    "dbInfo",
                    "dbDict",
                    "selected"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "var treeProperty = {};\r",
                    "if (selected) {\r",
                    "  treeProperty.enableSummary = dbDict.enableSummary;\r",
                    "  treeProperty.provider = dbDict.Provider;//dbPro;\r",
                    "}  else if (dbDict.enableSummary)\r",
                    "treeProperty.enableSummary = dbDict.enableSummary;\r",
                    "else\r",
                    "treeProperty.enableSummary = false;\r",
                    "\r",
                    "if (dbInfo) {\r",
                    "  var dbServer = dbInfo.dbServer;\r",
                    "  dbServer = (dbServer.toLowerCase() == 'localhost' ? '.' : dbServer);\r",
                    "  var upProvider = treeProperty.provider.toUpperCase();\r",
                    "  var serviceName = '';\r",
                    "  var serName = '';\r",
                    "  if (dbInfo.serName) {\r",
                    "    serviceName = serviceNamePane.items.items[0].value;\r",
                    "    serName = serviceNamePane.items.items[0].serName;\r",
                    "  }\r",
                    "  else if (dbInfo) {\r",
                    "    if (dbInfo.dbInstance)\r",
                    "    serviceName = dbInfo.dbInstance;\r",
                    "    if (dbInfo.serName)\r",
                    "    serName = dbInfo.serName;\r",
                    "  }\r",
                    "\r",
                    "  if (upProvider.indexOf('MSSQL') > -1) {\r",
                    "    var dbInstance = dbInfo.dbInstance;\r",
                    "    var dbDatabase = dbInfo.dbName;\r",
                    "    if (dbInstance.toUpperCase() == \"DEFAULT\") {\r",
                    "      var dataSrc = 'Data Source=' + dbServer + ';Initial Catalog=' + dbDatabase;\r",
                    "    } else {\r",
                    "      var dataSrc = 'Data Source=' + dbServer + '\\\\' + dbInstance + ';Initial Catalog=' + dbDatabase;\r",
                    "    }\r",
                    "  }\r",
                    "  else if (upProvider.indexOf('ORACLE') > -1)\r",
                    "  var dataSrc = 'Data Source=' + \r",
                    "  '(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=' + \r",
                    "  dbServer + ')(PORT=' + dbInfo.portNumber + \r",
                    "  ')))(CONNECT_DATA=(SERVER=DEDICATED)(' + serName + '=' + serviceName + ')))';\r",
                    "  else if (upProvider.indexOf('MYSQL') > -1)\r",
                    "  var dataSrc = 'Data Source=' + dbServer;\r",
                    "  treeProperty.connectionString = dataSrc + ';User ID=' + dbInfo.dbUserName + ';Password=' + dbInfo.dbPassword;\r",
                    "  treeProperty.schemaName = dbDict.SchemaName;\r",
                    "}\r",
                    "else {\r",
                    "  treeProperty.provider = dbDict.Provider;\r",
                    "  var dbServer = dbInfo.dbServer;\r",
                    "  var upProvider = treeProperty.provider.toUpperCase();\r",
                    "  dbServer = (dbServer.toLowerCase() == 'localhost' ? '.' : dbServer);\r",
                    "\r",
                    "  if (upProvider.indexOf('MSSQL') > -1) {\r",
                    "    if (dbInfo.dbInstance) {\r",
                    "      if (dbInfo.dbInstance.toUpperCase() == \"DEFAULT\") {\r",
                    "        var dataSrc = 'Data Source=' + dbServer + ';Initial Catalog=' + dbInfo.dbName;\r",
                    "      } else {\r",
                    "        var dataSrc = 'Data Source=' + dbServer + '\\\\' + dbInfo.dbInstance + ';Initial Catalog=' + dbInfo.dbName;\r",
                    "      }\r",
                    "    }\r",
                    "  }\r",
                    "  else if (upProvider.indexOf('ORACLE') > -1)\r",
                    "  var dataSrc = 'Data Source=' + '(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=' + \r",
                    "  dbServer + ')(PORT=' + dbInfo.portNumber + ')))(CONNECT_DATA=(SERVER=DEDICATED)(' + \r",
                    "  dbInfo.serName + '=' + dbInfo.dbInstance + ')))';\r",
                    "  else if (upProvider.indexOf('MYSQL') > -1)\r",
                    "  var dataSrc = 'Data Source=' + dbServer;\r",
                    "\r",
                    "  treeProperty.connectionString = dataSrc + ';User ID=' + dbInfo.dbUserName + ';Password=' + dbInfo.dbPassword;\r",
                    "  treeProperty.schemaName = dbDict.SchemaName;\r",
                    "}\r",
                    "return treeProperty;"
                ]
            },
            "designerId": "953eecce-9efb-4e77-8bb2-8fc5876af708"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getFolderFromChildNode",
                "designer|params": [
                    "folderNode",
                    "dbDictNode"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "var folderNodeProp = folderNode.data.property;\r",
                    "var folder = {};\r",
                    "var keyName = '';\r",
                    "if(dbDictNode){\r",
                    "  folder.tableName = dbDictNode.tableName;//folderNode.data.text;//folderNodeProp.tableName;\r",
                    "  folder.objectNamespace = dbDictNode.objectNamespace;//folderNode.raw.properties.objectNamespace;//folderNodeProp.objectNamespace;\r",
                    "  folder.objectName = dbDictNode.objectName;//folderNode.raw.properties.objectName;//folderNodeProp.objectName;\r",
                    "  folder.description = dbDictNode.description;//folderNode.raw.properties.description;//'';//folderNodeProp.description;\r",
                    "  if(dbDictNode.keyDelimeter && dbDictNode.keyDelimeter!= null)\r",
                    "  folder.keyDelimeter = dbDictNode.keyDelimeter;//folderNode.raw.properties.keyDelimeter;\r",
                    "  else\r",
                    "  folder.keyDelimeter = '_';\r",
                    "}\r",
                    "else{\r",
                    "  folder.tableName = folderNode.data.text;\r",
                    "  folder.objectNamespace = folderNode.raw.properties.objectNamespace;//folderNodeProp.objectNamespace;\r",
                    "  folder.objectName = folderNode.raw.properties.objectName;//folderNodeProp.objectName;\r",
                    "  folder.description = folderNode.raw.properties.description;//'';//folderNodeProp.description;\r",
                    "\r",
                    "  if (folderNode.raw.properties.keyDelimeter && folderNode.raw.properties.keyDelimeter != 'null')\r",
                    "  folder.keyDelimeter = folderNode.raw.properties.keyDelimeter;\r",
                    "  //folderNode.raw.properties.keyDelimeter = folderNode.raw.properties.keyDelimeter;  \r",
                    "  else\r",
                    "  folder.keyDelimeter = '_';\r",
                    "}\r",
                    "\r",
                    "\r",
                    "\r",
                    "\r",
                    "\r",
                    "folder.keyProperties = [];\r",
                    "folder.dataProperties = [];\r",
                    "folder.dataRelationships = [];\r",
                    "\r",
                    "folderNode.eachChild(function(child) {\r",
                    "\r",
                    "});\r",
                    "\r",
                    "for (var j = 0; j < folderNode.childNodes.length; j++) {\r",
                    "  if (folderNode.childNodes[1])\r",
                    "  var propertyFolderNode = folderNode.childNodes[1];    \r",
                    "\r",
                    "  if (folderNode.childNodes[0])\r",
                    "  var keyFolderNode = folderNode.childNodes[0];   \r",
                    "\r",
                    "  if (folderNode.childNodes[2])\r",
                    "  var relationFolderNode = folderNode.childNodes[2];   \r",
                    "\r",
                    "  if (folderNode.childNodes[j])\r",
                    "  subFolderNodeText = folderNode.childNodes[j].data.text;\r",
                    "\r",
                    "  switch (subFolderNodeText) {\r",
                    "    case 'Keys':\r",
                    "    if (keyFolderNode)\r",
                    "    var keyChildenNodes = keyFolderNode.childNodes;       \r",
                    "\r",
                    "    for (var k = 0; k < keyChildenNodes.length; k++) {\r",
                    "      var keyNode = keyChildenNodes[k];          \r",
                    "      var keyProps = {};\r",
                    "\r",
                    "      if (keyNode.data.property)\r",
                    "      var keyNodeProf = keyNode.data.property;         \r",
                    "\r",
                    "      keyProps.keyPropertyName = keyNode.data.text;\r",
                    "      keyName = keyNode.data.text;\r",
                    "      folder.keyProperties.push(keyProps);\r",
                    "      var tagProps = {};\r",
                    "      tagProps.columnName = keyNodeProf.columnName;\r",
                    "      tagProps.propertyName = keyNode.data.text;\r",
                    "\r",
                    "      if (typeof keyNodeProf.dataType == 'string')\r",
                    "      tagProps.dataType = me.getDataTypeIndex(keyNodeProf.dataType);\r",
                    "      else\r",
                    "      tagProps.dataType = keyNodeProf.dataType;\r",
                    "\r",
                    "      tagProps.dataLength = keyNodeProf.dataLength;\r",
                    "\r",
                    "      if (keyNodeProf.nullable)\r",
                    "      tagProps.isNullable = keyNodeProf.nullable.toString().toLowerCase();\r",
                    "      else\r",
                    "      tagProps.isNullable = 'false';\r",
                    "      if (keyNodeProf.isHidden)\r",
                    "      tagProps.isHidden = keyNodeProf.isHidden.toString().toLowerCase();\r",
                    "      else\r",
                    "      tagProps.isHidden = 'false';\r",
                    "\r",
                    "      //tagProps.isHidden = 'false';\r",
                    "\r",
                    "      if (!keyNodeProf.keyType)\r",
                    "      tagProps.keyType = 1;\r",
                    "      else\r",
                    "      if (typeof keyNodeProf.keyType != 'string')\r",
                    "      tagProps.keyType = keyNodeProf.keyType;\r",
                    "      else {\r",
                    "        switch (keyNodeProf.keyType.toLowerCase()) {\r",
                    "          case 'assigned':\r",
                    "          tagProps.keyType = 1;\r",
                    "          break;\r",
                    "          case 'unassigned':\r",
                    "          tagProps.keyType = 0;\r",
                    "          break;\r",
                    "          default:\r",
                    "          tagProps.keyType = 1;\r",
                    "          break;\r",
                    "        }\r",
                    "      }\r",
                    "\r",
                    "      if (keyNodeProf.showOnIndex)\r",
                    "      tagProps.showOnIndex = keyNodeProf.showOnIndex.toString().toLowerCase();\r",
                    "      else\r",
                    "      tagProps.showOnIndex = 'false';\r",
                    "\r",
                    "      tagProps.numberOfDecimals = keyNodeProf.numberOfDecimals;\r",
                    "      folder.dataProperties.push(tagProps);    \r",
                    "    }\r",
                    "    break;\r",
                    "    case 'Properties':\r",
                    "    if (folderNode.childNodes[1]) {\r",
                    "      var propChildenNodes = propertyFolderNode.childNodes;\r",
                    "      if(propChildenNodes.length > 0)\r",
                    "      folder = me.prepareProperties(folder, propChildenNodes, 'false', keyName);\r",
                    "    }\r",
                    "    break;\r",
                    "    case 'Relationships':\r",
                    "    if (!relationFolderNode)\r",
                    "    break;\r",
                    "\r",
                    "    if (relationFolderNode.childNodes)\r",
                    "    var relChildenNodes = relationFolderNode.childNodes;       \r",
                    "\r",
                    "    if (relChildenNodes)\r",
                    "    for (var k = 0; k < relChildenNodes.length; k++) {\r",
                    "      var relationNode = relChildenNodes[k];\r",
                    "      var found = false;\r",
                    "      for (var ik = 0; ik < folder.dataRelationships.length; ik++)\r",
                    "      if (relationNode.data.text.toLowerCase() == folder.dataRelationships[ik].relationshipName.toLowerCase()) {\r",
                    "        found = true;\r",
                    "        break;\r",
                    "      }\r",
                    "\r",
                    "      if (found || relationNode.data.text === '')\r",
                    "      continue;\r",
                    "\r",
                    "      //relationNodeAttr = relationNode.data;\r",
                    "      relationNodeAttr = relationNode.raw;\r",
                    "      var relation = {};\r",
                    "      relation.propertyMaps = [];\r",
                    "      var pMap;\r",
                    "      if(relationNode.data.propertyMap!=undefined)\r",
                    "      pMap = relationNode.data.propertyMap;\r",
                    "      else\r",
                    "      pMap = relationNodeAttr.propertyMap;\r",
                    "      for (var m = 0; m < pMap.length; m++) {\r",
                    "        var propertyPairNode = pMap[m];\r",
                    "        var propertyPair = {};\r",
                    "\r",
                    "        propertyPair.dataPropertyName = propertyPairNode.dataPropertyName;\r",
                    "        propertyPair.relatedPropertyName = propertyPairNode.relatedPropertyName;\r",
                    "        relation.propertyMaps.push(propertyPair);\r",
                    "      }\r",
                    "\r",
                    "      relation.relatedObjectName = relationNodeAttr.relatedObjectName;\r",
                    "      relation.relationshipName = relationNodeAttr.text;\r",
                    "      relation.relationshipType = relationNodeAttr.relationshipTypeIndex;\r",
                    "      folder.dataRelationships.push(relation);\r",
                    "    }\r",
                    "    break;\r",
                    "  }\r",
                    "}\r",
                    "return folder;"
                ]
            },
            "designerId": "9d5001a3-d9e5-44f6-85cb-12abb962057e"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "prepareProperties",
                "designer|params": [
                    "folder",
                    "propChildNodes",
                    "ifHidden",
                    "keyName"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "var hasData = false;\r",
                    "if(propChildNodes.length === 0) return folder;\r",
                    "for (var k = 0; k < propChildNodes.length; k++) {\r",
                    "  var propertyNode = propChildNodes[k];\r",
                    "\r",
                    "  if (propertyNode.data !== undefined) {\r",
                    "    if (propertyNode.data.property !== undefined) {\r",
                    "      var propertyNodeProf = propertyNode.data.property;\r",
                    "      hasData = true;\r",
                    "    }\r",
                    "  }\r",
                    "\r",
                    "  if (!hasData)\r",
                    "  var propertyNodeProf = propertyNode.data.property;//propertyNode.raw.properties;\r",
                    "\r",
                    "  var props = {};\r",
                    "  if(propertyNode.raw.properties == undefined && propertyNode.raw.property!=undefined)\r",
                    "  propertyNode.raw.properties = propertyNode.raw.property;\r",
                    "\r",
                    "  props.columnName = propertyNodeProf.columnName;//propertyNode.raw.properties.columnName;\r",
                    "  props.propertyName = propertyNodeProf.propertyName;//propertyNode.raw.properties.propertyName;\r",
                    "\r",
                    "  if (typeof propertyNode.raw.properties.dataType.toLowerCase() == 'string')\r",
                    "  props.dataType = me.getDataTypeIndex(propertyNode.raw.properties.dataType);\r",
                    "  else\r",
                    "  props.dataType = propertyNodeProf.dataType;\r",
                    "\r",
                    "  props.dataLength = propertyNode.raw.properties.dataLength;\r",
                    "\r",
                    "  if (propertyNode.raw.properties.nullable)\r",
                    "  props.isNullable =propertyNode.raw.properties.nullable.toString().toLowerCase();\r",
                    "  else\r",
                    "  props.isNullable = 'false';\r",
                    "\r",
                    "  if (keyName !== '') {\r",
                    "    if (props.columnName == keyName)\r",
                    "    props.keyType = 1;\r",
                    "    else\r",
                    "    props.keyType = 0;\r",
                    "  }\r",
                    "  else\r",
                    "  props.keyType = 0;\r",
                    "\r",
                    "  if (propertyNode.raw.properties.showOnIndex)\r",
                    "  props.showOnIndex = propertyNode.raw.properties.showOnIndex.toString().toLowerCase();\r",
                    "  else\r",
                    "  props.showOnIndex = 'false';\r",
                    "\r",
                    "  props.isHidden = propertyNode.raw.properties.isHidden.toString().toLowerCase();//ifHidden;\r",
                    "  props.numberOfDecimals = propertyNode.raw.properties.numberOfDecimals;\r",
                    "  folder.dataProperties.push(props);\r",
                    "}\r",
                    "return folder;"
                ]
            },
            "designerId": "03c466ab-70e2-466f-b918-ba7fd3cc45d7"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getDataTypeIndex",
                "designer|params": [
                    "dataType"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "if (me.dataTypes === undefined)\r",
                    "return;\r",
                    "\r",
                    "var i = 0;\r",
                    "\r",
                    "while (me.dataTypes[i] === undefined)\r",
                    "i++;\r",
                    "\r",
                    "for (var k = i; k < me.dataTypes.length; k++) {\r",
                    "  if (me.dataTypes[k][1] == dataType)\r",
                    "  return me.dataTypes[k][0];\r",
                    "}"
                ]
            },
            "designerId": "528af08b-1648-498a-8b40-17edeca33caf"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getDataTypes",
                "implHandler": [
                    "var me = this;\r",
                    "Ext.Ajax.request({\r",
                    "  url: 'AdapterManager/DataType',\r",
                    "  method: 'GET',\r",
                    "  timeout: 6000000,\r",
                    "  success: function (response, request) {\r",
                    "    var dataTypeName = Ext.JSON.decode(response.responseText);\r",
                    "    me.dataTypes = [];\r",
                    "    var i = 0;\r",
                    "    while (!dataTypeName[i])\r",
                    "    i++;\r",
                    "    while (dataTypeName[i]) {\r",
                    "      me.dataTypes.push([i, dataTypeName[i]]);\r",
                    "      i++;\r",
                    "    }\r",
                    "  },\r",
                    "  failure: function (f, a) {\r",
                    "    if (a.response)\r",
                    "    showDialog(500, 400, 'Error', a.response.responseText, Ext.Msg.OK, null);\r",
                    "  }\r",
                    "});"
                ]
            },
            "designerId": "36f62e6e-efae-4a55-80be-7b79ff4ae1a1"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onConnectToDatabase",
                "implHandler": [
                    "var me = this;\r",
                    "var form = button.up('connectionstringform');\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var dataTree = panel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var context = dirNode.parentNode.data.text;//dirNode.data.record.ContextName;\r",
                    "var endpoint = dirNode.data.record.Name;//dirNode.data.record.Endpoint;\r",
                    "var baseUrl = dirNode.data.record.BaseUrl;\r",
                    "var content = me.getMainContent();\r",
                    "var dbProvider = form.getForm().findField('dbProvider').getValue().toUpperCase();\r",
                    "var dbName = form.getForm().findField('dbName');\r",
                    "var portNumber = form.getForm().findField('portNumber');\r",
                    "var host = form.getForm().findField('host');\r",
                    "var dbServer = form.getForm().findField('dbServer');\r",
                    "var dbInstance = form.getForm().findField('dbInstance');\r",
                    "var serviceNamePane = form.items.items[10];\r",
                    "var dbSchema = form.getForm().findField('dbSchema');\r",
                    "var servieName = '';\r",
                    "var serName = '';\r",
                    "dbPro  = dbProvider;\r",
                    "dbSch = dbSchema.getValue();\r",
                    "//dirNode.data.record.dbDict.Provider = dbProvider;\r",
                    "//dirNode.data.record.dbDict.SchemaName = dbSchema.getValue();\r",
                    "\r",
                    "if (dbProvider.indexOf('ORACLE') > -1) {\r",
                    "  dbServer.setValue(host.getValue());\r",
                    "  dbName.setValue(dbSchema.getValue());\r",
                    "  servieName = serviceNamePane.items.items[0].value;\r",
                    "  serName = serviceNamePane.items.items[0].serName;\r",
                    "  dbInstance.setValue(servieName);\r",
                    "}\r",
                    "else if (dbProvider.indexOf('MSSQL') > -1) {\r",
                    "  host.setValue(dbServer.getValue());\r",
                    "  serviceName = dbInstance.getValue();\r",
                    "  dbSchema.setValue(dbSchema.getValue());\r",
                    "  //dbPro.setValue(dbProvider);\r",
                    "}\r",
                    "else if (dbProvider.indexOf('MYSQL') > -1) {\r",
                    "  dbName.setValue(dbSchema.getValue());\r",
                    "  dbInstance.setValue(dbSchema.getValue());\r",
                    "}\r",
                    "\r",
                    "form.getForm().submit({\r",
                    "  url: 'AdapterManager/TableNames',//'nhibernate/TableNames',\r",
                    "  method: 'POST',\r",
                    "  timeout: 600000,\r",
                    "  params: {\r",
                    "    scope: context,\r",
                    "    app: endpoint,\r",
                    "    serName: serName,\r",
                    "    baseUrl: baseUrl\r",
                    "  },\r",
                    "  success: function (f, a) {\r",
                    "    dirNode.data.record.dbInfo = form.getForm().getValues();\r",
                    "    var dbInfo = dirNode.data.record.dbInfo;\r",
                    "\r",
                    "    dbInfo.dbTableNames = Ext.JSON.decode(a.response.responseText);\r",
                    "    panel.dirNode = dirNode;\r",
                    "\r",
                    "    me.showSelectTablesForm(panel);\r",
                    "    return;\r",
                    "\r",
                    "  },\r",
                    "  failure: function (f, a) {\r",
                    "    if (a.response)\r",
                    "    showDialog(500, 400, 'Error', a.response.responseText, Ext.Msg.OK, null);\r",
                    "    else {\r",
                    "      showDialog(400, 100, 'Warning', 'Please fill in every field in this form.', Ext.Msg.OK, null);\r",
                    "    }\r",
                    "  }//,\r",
                    "  // waitMsg: 'Loading ...'\r",
                    "});"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "button[action=connecttodatabase]"
            },
            "designerId": "de3da772-eb44-4a0f-b69b-eca09bb6bf6d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onSaveDataObjects",
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "var content = this.getMainContent();\r",
                    "var panel = button.up('nhibernatepanel');\r",
                    "var dbObjectsTree = panel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dbObjectsTree.dirNode);\r",
                    "var rootNode = dbObjectsTree.getRootNode();\r",
                    "var form = panel.down('selecttablesform');\r",
                    "//var objectGrid = form.down('multiselectcomponentgrid').items.items[2];//form.down('multiselectiongrid');\r",
                    "//var boundlist = objectGrid.items.items[0].items.items[2].items.items[0].items.items[0];\r",
                    "var selected = form.down('multiselectcomponentgrid').items.items[2].items.items[0].items.items[2].store.data.items;//objectGrid.getSelections(boundlist);//objectGrid.getSelectionModel().getSelection();\r",
                    "\r",
                    "var serName = '';\r",
                    "var dbInfo = dirNode.data.record.dbInfo;\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "\r",
                    "var context = dirNode.parentNode.data.text;\r",
                    "var datalayer = dirNode.data.record.DataLayer;\r",
                    "var endpoint = dirNode.data.record.Name;\r",
                    "var baseUrl = dirNode.data.record.BaseUrl;\r",
                    "\r",
                    "if( dbDict.Provider == null)\r",
                    "dbDict.Provider = dbPro;\r",
                    "if( dbDict.SchemaName == null)\r",
                    "dbDict.SchemaName = dbSch;\r",
                    "\r",
                    "dbInfo.dbSchema = dbDict.SchemaName;\r",
                    "dbDict.enableSummary = form.getForm().findField('enableSummary').value;\r",
                    "if (dbObjectsTree.disabled) {\r",
                    "  dbObjectsTree.enable();\r",
                    "}\r",
                    "\r",
                    "if (dbInfo.serName)\r",
                    "serName = dbInfo.serName;\r",
                    "var flag = true;\r",
                    "if (selected.length < 1) {\r",
                    "  while (rootNode.firstChild) {\r",
                    "    rootNode.removeChild(rootNode.firstChild);\r",
                    "    flag = false;\r",
                    "  }\r",
                    "  if(flag)\r",
                    "  showDialog(200, 100, 'Warning', 'No tables selected....', Ext.Msg.OK, null);\r",
                    "  return;\r",
                    "} else {\r",
                    "\r",
                    "  userTableNames = [];\r",
                    "  Ext.each(selected, function (table) {\r",
                    "    userTableNames.push(table.data.text);\r",
                    "  });\r",
                    "}\r",
                    "dbObjectsTree.selectedTables = userTableNames;\r",
                    "\r",
                    "var treeStore = dbObjectsTree.getStore();\r",
                    "treeStore.on('beforeload', function (store, operation) {\r",
                    "  var params = store.proxy.extraParams;\r",
                    "  params.dbProvider = dirNode.data.record.dbDict.Provider;//dbPro;//dbDict.Provider;\r",
                    "  params.dbServer = dbInfo.dbServer;\r",
                    "  params.dbInstance = dbInfo.dbInstance;\r",
                    "  params.dbName = dbInfo.dbName;\r",
                    "  params.dbSchema = dirNode.data.record.dbDict.SchemaName;//dbSch;//dbInfo.dbSchema;\r",
                    "  params.dbPassword = dbInfo.dbPassword;\r",
                    "  params.dbUserName = dbInfo.dbUserName;\r",
                    "  params.portNumber = dbInfo.portNumber;\r",
                    "  params.tableNames = userTableNames;\r",
                    "  params.serName = serName;\r",
                    "  params.scope = dirNode.parentNode.data.text;//dirNode.data.record.ContextName;\r",
                    "  params.app = dirNode.data.record.Name;//dirNode.data.record.Endpoint;\r",
                    "  params.baseUrl = dirNode.data.record.BaseUrl;\r",
                    "}, me);\r",
                    "\r",
                    "panel.body.mask('Loading...', 'x-mask-loading');\r",
                    "//treeStore.load();\r",
                    "treeStore.load({\r",
                    "  callback: function (records, options, success) {\r",
                    "    var rootNode = treeStore.getRootNode();\r",
                    "    me.reloadTree(rootNode, dbDict);\r",
                    "\r",
                    "  }\r",
                    "});\r",
                    "me.getTableNames(context, endpoint, baseUrl, dirNode);\r",
                    "panel.body.unmask();"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "button[action=applyobjects]"
            },
            "designerId": "3e1f10e8-8741-424a-b907-8228eb4ccee2"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "resetConfigOracle",
                "designer|params": [
                    "host",
                    "dbSchema",
                    "userName",
                    "password",
                    "serviceName",
                    "sid",
                    "serName"
                ],
                "implHandler": [
                    "host.setValue('');\r",
                    "host.clearInvalid();\r",
                    "\r",
                    "host.show();\r",
                    "\r",
                    "dbSchema.setValue('');\r",
                    "dbSchema.clearInvalid();\r",
                    "\r",
                    "userName.setValue('');\r",
                    "userName.clearInvalid();\r",
                    "\r",
                    "password.setValue('');\r",
                    "password.clearInvalid();\r",
                    "serviceName.show();\r",
                    "\r",
                    "sid.setValue('');\r",
                    "sid.clearInvalid();\r",
                    "\r",
                    "sid.setValue('');\r",
                    "sid.clearInvalid(); "
                ]
            },
            "designerId": "b97ade21-d9f9-4fd2-94f7-41a04f894485"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "resetConfigMsSql",
                "designer|params": [
                    "dbName",
                    "dbServer",
                    "dbInstance",
                    "dbSchema",
                    "userName",
                    "password"
                ],
                "implHandler": [
                    "dbName.setValue('');\r",
                    "dbName.clearInvalid();\r",
                    "dbName.show();\r",
                    "\r",
                    "dbServer.setValue('localhost');\r",
                    "dbServer.show();\r",
                    "\r",
                    "dbInstance.setValue('default');\r",
                    "dbInstance.show();\r",
                    "\r",
                    "dbSchema.setValue('dbo');\r",
                    "\r",
                    "userName.setValue('');\r",
                    "userName.clearInvalid();\r",
                    "\r",
                    "password.setValue('');\r",
                    "password.clearInvalid();"
                ]
            },
            "designerId": "7a887148-8f8c-4221-9130-9effead85cdc"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onResetDataObjects",
                "implHandler": [
                    "var me = this;\r",
                    "var form = button.up('selecttablesform');\r",
                    "var grid = form.down('multiselectiongrid');\r",
                    "\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var dataTree = panel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var dbInfo = dirNode.data.record.dbInfo;\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "var rootNode = dataTree.getRootNode();\r",
                    "var selectTableNamesSingle = [];\r",
                    "var availTableName = [];\r",
                    "var found = false;\r",
                    "var repeatItem;\r",
                    "for (var i = 0; i < dbInfo.dbTableNames.items.length; i++) {\r",
                    "  repeatItem = dbInfo.dbTableNames.items[i];\r",
                    "  availTableName.push([repeatItem, repeatItem]);\r",
                    "}\r",
                    "\r",
                    "for (var j = 0; j < availTableName.length; j++)\r",
                    "for (var i = 0; i < rootNode.childNodes.length; i++) {\r",
                    "  //if (rootNode.childNodes[i].data.property.tableName.toLowerCase() == availTableName[j][0].toLowerCase()) {\r",
                    "  if (rootNode.childNodes[i].raw.properties.objectName.toLowerCase() == availTableName[j][0].toLowerCase()) {\r",
                    "    found = true;\r",
                    "    availTableName.splice(j, 1);\r",
                    "    j--;\r",
                    "    break;\r",
                    "  }\r",
                    "}\r",
                    "\r",
                    "for (var i = 0; i < rootNode.childNodes.length; i++) {\r",
                    "  var nodeText = rootNode.childNodes[i].raw.properties.objectName;//rootNode.childNodes[i].data.property.tableName;\r",
                    "  selectTableNamesSingle.push(nodeText);\r",
                    "}\r",
                    "var itemSelecter = form.down('#multiselectcomponentgrid');\r",
                    "itemSelecter.items.items[2].bindStore(grid.getStore());\r",
                    "\r",
                    "if(selectTableNamesSingle){\r",
                    "  var records = [];\r",
                    "  for(var jj=0;jj<selectTableNamesSingle.length;jj++){\r",
                    "    for(var  kk = 0;kk<grid.getStore().data.length;kk++){\r",
                    "      if(selectTableNamesSingle[jj] == grid.getStore().data.items[kk].data.text){\r",
                    "        records.push(grid.getStore().data.items[kk]);\r",
                    "        itemSelecter.items.items[2].items.items[0].items.items[0].getStore().remove(grid.getStore().data.items[kk]);\r",
                    "        break;\r",
                    "      }\r",
                    "    }     \r",
                    "  }\r",
                    "\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[2].getStore().add(records);\r",
                    "}\r",
                    "\r",
                    "\r",
                    "//grid.selectItems(selectTableNamesSingle);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "selecttablesform button[action=resetobjects]"
            },
            "designerId": "a71a2f2f-bc04-43cd-bf27-8743c34357bf"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onFormCreaterelation",
                "implHandler": [
                    "var me = this;\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "me.showSetRelationForm(panel);"
                ],
                "name": "createrelation",
                "scope": "me",
                "designer|targetType": "nhibernate.RelationsForm",
                "designer|controlQuery": "form"
            },
            "designerId": "eef83448-eb62-4dcc-bdc1-93c50fb42388"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "reloadTree",
                "designer|params": [
                    "rootNode",
                    "dbDict"
                ],
                "implHandler": [
                    "//alert('This is reloadTree...');\r",
                    "var me = this;\r",
                    "var relationTypeStr = ['OneToOne', 'OneToMany'];\r",
                    "\r",
                    "// sync data object tree with data dictionary\r",
                    "for (var i = 0; i < rootNode.childNodes.length; i++) {\r",
                    "  var dataObjectNode = rootNode.childNodes[i];\r",
                    "\r",
                    "  //dataObjectNode.attributes.properties.tableName = dataObjectNode.text;\r",
                    "  for (var ijk = 0; ijk < dbDict.dataObjects.length; ijk++) {\r",
                    "    var dataObject = dbDict.dataObjects[ijk];\t\t  \r",
                    "\r",
                    "    if (dataObjectNode.data.text.toUpperCase() != dataObject.tableName.toUpperCase())\r",
                    "    continue;\r",
                    "\r",
                    "    // sync data object\r",
                    "    //dataObjectNode.attributes.properties.objectNamespace = dataObject.objectNamespace;\r",
                    "    dataObjectNode.raw.properties.objectNamespace = dataObject.objectNamespace;\r",
                    "    //dataObjectNode.attributes.properties.objectName = dataObject.objectName;\r",
                    "    dataObjectNode.raw.properties.objectName = dataObject.objectName;\r",
                    "    //dataObjectNode.attributes.properties.keyDelimiter = dataObject.keyDelimeter;\r",
                    "    dataObjectNode.raw.properties.keyDelimiter = dataObject.keyDelimeter;\r",
                    "\r",
                    "    //dataObjectNode.attributes.properties.description = dataObject.description;\r",
                    "\r",
                    "    dataObjectNode.data.text = dataObject.objectName;\r",
                    "    //dataObjectNode.attributes.text = dataObject.objectName;\r",
                    "    //dataObjectNode.setText(dataObject.objectName);\r",
                    "\r",
                    "    if (dataObject.objectName.toLowerCase() == dataObjectNode.data.text.toLowerCase()) {\r",
                    "      var shownProperty = new Array();\t\r",
                    "      var keysNode = dataObjectNode.childNodes[0];//dataObjectNode.attributes.children[0];\r",
                    "      var propertiesNode = dataObjectNode.childNodes[1];//dataObjectNode.attributes.children[1];\r",
                    "      var relationshipsNode = dataObjectNode.childNodes[2];//dataObjectNode.attributes.children[2];\r",
                    "      utilsObj.availableDataProperties = propertiesNode.data.children;\r",
                    "      var selectedItems = [];\r",
                    "      var availableItems = [];\r",
                    "      var myFlag;\r",
                    "      // sync data properties\r",
                    "      for (var j = 0; j < propertiesNode.data.children.length; j++) {\r",
                    "        myFlag = true;\r",
                    "        for (var jj = 0; jj < dataObject.dataProperties.length; jj++) {\r",
                    "          if (propertiesNode.data.children[j].text.toLowerCase() == dataObject.dataProperties[jj].columnName.toLowerCase()) {\r",
                    "\r",
                    "            /*if (!me.shown(shownProperty, propertiesNode.data.children[j].text.toLowerCase())) {\r",
                    "            shownProperty.push(propertiesNode.data.children[j].text.toLowerCase());\r",
                    "            propertiesNode.data.children[j].hidden = true;\r",
                    "            }*/\r",
                    "            propertiesNode.childNodes[j].data.text = dataObject.dataProperties[jj].propertyName;\r",
                    "            propertiesNode.childNodes[j].data.property.propertyName = dataObject.dataProperties[jj].propertyName;\r",
                    "            propertiesNode.childNodes[j].data.property.isHidden = dataObject.dataProperties[jj].isHidden;\r",
                    "\r",
                    "            propertiesNode.data.children[j].text = dataObject.dataProperties[jj].propertyName;\r",
                    "            propertiesNode.data.children[j].properties.propertyName = dataObject.dataProperties[jj].propertyName;\r",
                    "            propertiesNode.data.children[j].properties.isHidden = dataObject.dataProperties[jj].isHidden;\r",
                    "            selectedItems.push(propertiesNode.data.children[j]);\r",
                    "            myFlag = false;\r",
                    "          }\r",
                    "        }\r",
                    "        if(myFlag){\r",
                    "          availableItems.push(propertiesNode.data.children[j]);\r",
                    "          //propertiesNode.data.children.splice(j, 1);\r",
                    "          //propertiesNode.removeChild(propertiesNode.data.children[j], false);\r",
                    "        }\r",
                    "      }\r",
                    "      //propertiesNode.removeAll();\r",
                    "      /*for(p = 0;p<dataObject.keyProperties.length;p++){\r",
                    "      for(q = 0;q<selectedItems.length;q++){\r",
                    "      if(dataObject.keyProperties[p].keyPropertyName == selectedItems[q].text)\r",
                    "      selectedItems.splice(selectedItems[q],1);\r",
                    "      break;\r",
                    "      }\r",
                    "      }*/\r",
                    "      for(m =0;m<availableItems.length;m++){\r",
                    "        for(n = 0;n<propertiesNode.childNodes.length;n++){\r",
                    "          if(propertiesNode.childNodes[n].data.text == availableItems[m].text)\r",
                    "          propertiesNode.removeChild(propertiesNode.childNodes[n]);\r",
                    "        }\r",
                    "      }\r",
                    "      for(jj =0;jj<dataObject.keyProperties.length;jj++){\r",
                    "        for(kk = 0;kk<propertiesNode.childNodes.length;kk++){\r",
                    "          if(propertiesNode.childNodes[kk].data.text == dataObject.keyProperties[jj].keyPropertyName)\r",
                    "          propertiesNode.removeChild(propertiesNode.childNodes[kk]);\r",
                    "        }\r",
                    "      }\r",
                    "\r",
                    "      // sync key properties\r",
                    "      for (var ij = 0; ij < dataObject.keyProperties.length; ij++) {\r",
                    "        for (var k = 0; k < keysNode.data.children.length; k++) {\r",
                    "          for (var ikk = 0; ikk < dataObject.dataProperties.length; ikk++) {\r",
                    "            if (dataObject.keyProperties[ij].keyPropertyName.toLowerCase() == dataObject.dataProperties[ikk].propertyName.toLowerCase()) {\r",
                    "              if (keysNode.data.children[k].text.toLowerCase() == dataObject.dataProperties[ikk].columnName.toLowerCase()) {\r",
                    "                keysNode.data.children[k].text = dataObject.keyProperties[ij].keyPropertyName;\r",
                    "                //keysNode.data.children[k].properties.propertyName = dataObject.keyProperties[ij].keyPropertyName;\r",
                    "                keysNode.data.children[k].property.propertyName = dataObject.keyProperties[ij].keyPropertyName; \r",
                    "                keysNode.data.children[k].property.isHidden = dataObject.keyProperties[ij].isHidden;\r",
                    "                ij++;\r",
                    "                break;\r",
                    "              }\r",
                    "            }\r",
                    "          }\r",
                    "          break;\r",
                    "        }\r",
                    "        if (ij < dataObject.keyProperties.length) {\r",
                    "          for (var ijj = 0; ijj < propertiesNode.data.children.length; ijj++) {\r",
                    "            var nodeText = dataObject.keyProperties[ij].keyPropertyName;\r",
                    "            if (propertiesNode.data.children[ijj].text.toLowerCase() == nodeText.toLowerCase()) {\r",
                    "              var properties = propertiesNode.data.children[ijj].properties;\r",
                    "              properties.propertyName = nodeText;\r",
                    "              //properties.keyType = 'assigned';\r",
                    "              //properties.nullable = false;\r",
                    "\r",
                    "              /*newKeyNode = new Ext.tree.TreeNode({\r",
                    "              text: nodeText,\r",
                    "              type: \"keyProperty\",\r",
                    "              leaf: true,\r",
                    "              iconCls: 'treeKey',\r",
                    "              hidden: false,\r",
                    "              properties: properties\r",
                    "              });*/\r",
                    "              newKeyNode = {\r",
                    "                text: nodeText,\r",
                    "                type: \"keyProperty\",\r",
                    "                leaf: true,\r",
                    "                iconCls: 'treeKey',\r",
                    "                hidden: false,\r",
                    "                property: properties,\r",
                    "                properties:properties\r",
                    "              };\r",
                    "              newKeyNode.iconCls = 'treeKey';\r",
                    "              propertiesNode.data.children.splice(ijj, 1);\r",
                    "              ijj--;\r",
                    "\r",
                    "              if (newKeyNode)\r",
                    "              keysNode.appendChild(newKeyNode);\r",
                    "              //keysNode.data.children.push(newKeyNode);\r",
                    "\r",
                    "              break;\r",
                    "            }\r",
                    "          }\r",
                    "        }\r",
                    "      }\r",
                    "      var nodeToDelete = [];  \r",
                    "      if(keysNode.childNodes.length > dataObject.keyProperties.length){\r",
                    "        for(var z = 0;z<keysNode.childNodes.length;z++){\r",
                    "          var availFlag = true;\r",
                    "          for(var x = 0; x< dataObject.keyProperties.length;x++){\r",
                    "            if(keysNode.childNodes[z].data.text == dataObject.keyProperties[x].keyPropertyName){\r",
                    "              availFlag = false;\r",
                    "            }\r",
                    "          }\r",
                    "          if(availFlag)\r",
                    "          nodeToDelete.push(keysNode.childNodes[z]);\r",
                    "          //keysNode.childNodes.splice(z, 1);\r",
                    "        }\r",
                    "        for(var s = 0;s<nodeToDelete.length;s++){\r",
                    "          keysNode.childNodes.splice(s, 1);\r",
                    "          s--;\r",
                    "          nodeToDelete.length = nodeToDelete.length-1;\r",
                    "        }\r",
                    "      }\r",
                    "\r",
                    "      // sync relationships\r",
                    "      for (var kj = 0; kj < dataObject.dataRelationships.length; kj++) {\r",
                    "          /*var newNode = new Ext.tree.TreeNode({\r",
                    "              text: dataObject.dataRelationships[kj].relationshipName,\r",
                    "              type: 'relationship',\r",
                    "              leaf: true,\r",
                    "              iconCls: 'treeRelation',\r",
                    "              relatedObjMap: [],\r",
                    "              objectName: dataObjectNode.text,\r",
                    "              relatedObjectName: dataObject.dataRelationships[kj].relatedObjectName,\r",
                    "              relationshipType: relationTypeStr[dataObject.dataRelationships[kj].relationshipType],\r",
                    "              relationshipTypeIndex: dataObject.dataRelationships[kj].relationshipType,\r",
                    "              propertyMap: []\r",
                    "          });\r",
                    "          */\r",
                    "        var newNode = {\r",
                    "                text: dataObject.dataRelationships[kj].relationshipName,\r",
                    "                type: 'relationship',\r",
                    "                leaf: true,\r",
                    "                iconCls: 'treeRelation',\r",
                    "                relatedObjMap: [],\r",
                    "                objectName: dataObjectNode.data.text,\r",
                    "                relatedObjectName: dataObject.dataRelationships[kj].relatedObjectName,\r",
                    "                relationshipType: relationTypeStr[dataObject.dataRelationships[kj].relationshipType],\r",
                    "                relationshipTypeIndex: dataObject.dataRelationships[kj].relationshipType,\r",
                    "                propertyMap: []\r",
                    "              };\r",
                    "          var mapArray = new Array();\r",
                    "          for (var kjj = 0; kjj < dataObject.dataRelationships[kj].propertyMaps.length; kjj++) {\r",
                    "              var mapItem = new Array();\r",
                    "              mapItem['dataPropertyName'] = dataObject.dataRelationships[kj].propertyMaps[kjj].dataPropertyName;\r",
                    "              mapItem['relatedPropertyName'] = dataObject.dataRelationships[kj].propertyMaps[kjj].relatedPropertyName;\r",
                    "              mapArray.push(mapItem);\r",
                    "          }\r",
                    "          newNode.iconCls = 'treeRelation';\r",
                    "          //newNode.attributes.propertyMap = mapArray;\r",
                    "        \tnewNode.propertyMap = mapArray;  \r",
                    "        \trelationshipsNode.expanded = true;\r",
                    "          //relationshipsNode.children.push(newNode);\r",
                    "       \t\trelationshipsNode.appendChild(newNode);\r",
                    "        //relationshipsNode.data.children.push(newNode);\r",
                    "        \r",
                    "      }\r",
                    "    }\r",
                    "  }\r",
                    "  ijk++;\r",
                    "}\r",
                    "\r",
                    "if (rootNode.childNodes.length == 1)\r",
                    "if (rootNode.childNodes[0].text == \"\")\r",
                    "rootNode.removeChild(rootNode.childNodes[0], true);"
                ]
            },
            "designerId": "799c2a5f-afaa-47fb-b561-7921ef428dc9"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "shown",
                "designer|params": [
                    "shownArray",
                    "text"
                ],
                "implHandler": [
                    "/*alert('this is shown...');\r",
                    "for (var shownIndex = 0; shownIndex < shownArray.length; shownIndex++)\r",
                    "if (shownArray[shownIndex] == text)\r",
                    "return true;\r",
                    "return false;\r",
                    "*/"
                ]
            },
            "designerId": "120eef69-8c0d-4c9b-950e-58b5dd7f4b5a"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onResetSelectPropertiesForm",
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "var form = button.up('selectpropertiesform');\r",
                    "var grid = form.down('multiselectiongrid');\r",
                    "\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var dataTree = panel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(dataTree.dirNode);\r",
                    "var rootNode = dataTree.getRootNode();\r",
                    "var dataNode = dataTree.getSelectedNode();\r",
                    "var selectKeys = [];\r",
                    "var availTableName = [];\r",
                    "var found = false;\r",
                    "var repeatItem;\r",
                    "\r",
                    "for (var i = 0; i < dataNode.childNodes.length; i++) {\r",
                    "  var keyText = dataNode.childNodes[i].data.text;\r",
                    "  selectKeys.push(keyText);\r",
                    "}\r",
                    "\r",
                    "var itemSelecter = form.down('#multiselectcomponentgrid');\r",
                    "//itemSelecter.items.items[2].bindStore(grid.getStore());\r",
                    "itemSelecter.items.items[2].items.items[0].items.items[2].bindStore(grid.getStore());\r",
                    "if(selectKeys){\r",
                    "  var records = [];\r",
                    "  var flag;\r",
                    "  for(var jj=0;jj<dataNode.data.children.length;jj++){\r",
                    "    flag = true;\r",
                    "    for(var  kk = 0;kk< selectKeys.length;kk++){\r",
                    "      if(selectKeys[kk] == dataNode.data.children[jj].text){\r",
                    "        flag = false; \r",
                    "        //records.push(grid.getStore().data.items[kk]);\r",
                    "        //itemSelecter.items.items[2].items.items[0].items.items[0].getStore().remove(grid.getStore().data.items[kk]);\r",
                    "        break;\r",
                    "      }\r",
                    "    }\r",
                    "    if(flag){\r",
                    "      var tempflag = true;\r",
                    "      for(var ll = 0;ll<rootNode.childNodes.length;ll++){\r",
                    "        if(rootNode.childNodes[ll].data.text == dataNode.parentNode.data.text){\r",
                    "          for(var zz = 0; zz<rootNode.childNodes[ll].childNodes[0].childNodes.length;zz++){\r",
                    "            if(rootNode.childNodes[ll].childNodes[0].childNodes[zz].data.text == dataNode.data.children[jj].text)\r",
                    "            tempflag = false;\r",
                    "          }\r",
                    "        }\r",
                    "      }\r",
                    "      if(tempflag)\r",
                    "      records.push(dataNode.data.children[jj]);\r",
                    "    }\r",
                    "\r",
                    "\r",
                    "  }\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[0].getStore().removeAll();\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[0].getStore().add(records);\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[2].getStore().removeAll();\r",
                    "  itemSelecter.items.items[2].items.items[0].items.items[2].getStore().add(dataNode.childNodes);\r",
                    "  //itemSelecter.items.items[2].getStore().add(records);\r",
                    "}\r",
                    "\r",
                    "\r",
                    "//grid.selectItems(selectTableNamesSingle);"
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": "selectpropertiesform button[action=resetselectproperties] "
            },
            "designerId": "274f89b8-b37c-437f-a90b-6baec3d21c56"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onResetConnectionForm",
                "implHandler": [
                    "\r",
                    "var me = this;\r",
                    "var form = button.up('connectionstringform');\r",
                    "var panel = form.up('nhibernatepanel');\r",
                    "var tree = panel.down('nhibernatetree');\r",
                    "var dirNode = me.getDirNode(tree.dirNode);\r",
                    "var dbInfo = dirNode.data.record.dbInfo;\r",
                    "var dbDict = dirNode.data.record.dbDict;\r",
                    "\r",
                    "/*if(dbInfo && dbDict){\r",
                    "  form.getForm().findField('dbProvider').setValue(dbDict.Provider);\r",
                    "  form.getForm().findField('dbServer').setValue(dbInfo.dbServer);\r",
                    "  form.getForm().findField('dbInstance').setValue(dbInfo.dbInstance);\r",
                    "  form.getForm().findField('dbName').setValue(dbInfo.dbName);\r",
                    "  form.getForm().findField('dbUserName').setValue(dbInfo.dbUserName);\r",
                    "  form.getForm().findField('dbPassword').setValue(dbInfo.dbPassword);\r",
                    "  form.getForm().findField('dbSchema').setValue(dbDict.SchemaName);\r",
                    "}\r",
                    "*/\r",
                    "\r",
                    "\tvar dsConfigForm = button.up('connectionstringform').getForm();//dsConfigPane.getForm();\r",
                    "\tvar Provider = null;\r",
                    "\r",
                    "\tif (dbDict.Provider)\r",
                    "\t\tProvider = dbDict.Provider.toUpperCase();\r",
                    "\r",
                    "\tvar dbName = dsConfigForm.findField('dbName');\r",
                    "\tvar portNumber = dsConfigForm.findField('portNumber');\r",
                    "\tvar host = dsConfigForm.findField('host');\r",
                    "\tvar dbServer = dsConfigForm.findField('dbServer');\r",
                    "\tvar dbInstance = dsConfigForm.findField('dbInstance');\r",
                    "\t//var serviceName = dsConfigPane.items.items[10];\r",
                    "  var serviceName = dsConfigForm.findField('field_serviceName');\r",
                    "  var sid = dsConfigForm.findField('field_sid');\r",
                    "  var radioGroup = button.up('connectionstringform').query('#radioGroup')[0];\r",
                    "\tvar dbSchema = dsConfigForm.findField('dbSchema');\r",
                    "\tvar userName = dsConfigForm.findField('dbUserName');\r",
                    "\tvar password = dsConfigForm.findField('dbPassword');\r",
                    "\tvar dbProvider = dsConfigForm.findField('dbProvider');\r",
                    "  var oraclecontainer = button.up('connectionstringform').down('#oraclecontainer');\r",
                    "\tif (dbInfo) {\r",
                    "\t    if (Provider) {\r",
                    "\t\t\tif (Provider.indexOf('ORACLE') > -1) {\r",
                    "\t\t\t\tdbName.hide();\r",
                    "\t\t\t\tdbServer.hide();\r",
                    "\t\t\t\tdbInstance.hide();\r",
                    "\r",
                    "\t\t\t\tdbServer.setValue(dbInfo.dbServer);\r",
                    "\t\t\t\tdbInstance.setValue(dbInfo.dbInstance);\r",
                    "\t\t\t\tdbName.setValue(dbInfo.dbName);\r",
                    "\r",
                    "\t\t\t\tuserName.setValue(dbInfo.dbUserName);\r",
                    "\t\t\t\tpassword.setValue(dbInfo.dbPassword);\r",
                    "\t\t\t\tdbProvider.setValue(dbDict.Provider);\r",
                    "\t\t\t\tdbSchema.setValue(dbDict.SchemaName);\r",
                    "\r",
                    "\t\t\t\thost.setValue(dbInfo.dbServer);\r",
                    "\t\t\t\thost.show();\r",
                    "        \r",
                    "        oraclecontainer.show();\r",
                    "        //sid.show();\r",
                    "        //radioGroup.show();\r",
                    "        \r",
                    "\t\t\t\tserviceName.show();\r",
                    "\t\t\t\tcreatRadioField(serviceName, serviceName.id, dbInfo.dbInstance, dbInfo.serName);\r",
                    "\r",
                    "\t\t\t\tportNumber.setValue(dbInfo.portNumber);\r",
                    "\t\t\t\tportNumber.show();\r",
                    "\t\t\t}\r",
                    "\t\t\telse if (Provider.indexOf('MSSQL') > -1) {\r",
                    "\t\t\t\tportNumber.hide();\r",
                    "\t\t\t\thost.hide();\r",
                    "\t\t\t\tserviceName.hide();\r",
                    "        \r",
                    "        oraclecontainer.hide();\r",
                    "        //sid.hide();\r",
                    "        //radioGroup.hide();\r",
                    "\r",
                    "\t\t\t\tdbServer.setValue(dbInfo.dbServer);\r",
                    "\t\t\t\tdbServer.show();\r",
                    "\t\t\t\tdbInstance.setValue(dbInfo.dbInstance);\r",
                    "\t\t\t\tdbInstance.show();\r",
                    "\t\t\t\tdbName.setValue(dbInfo.dbName);\r",
                    "\t\t\t\tdbName.show();\r",
                    "\t\t\t\tdbProvider.setValue(dbDict.Provider);\r",
                    "\t\t\t\thost.setValue(dbInfo.dbServer);\r",
                    "\t\t\t\tportNumber.setValue(dbInfo.portNumber);\r",
                    "\t\t\t\tuserName.setValue(dbInfo.dbUserName);\r",
                    "\t\t\t\tpassword.setValue(dbInfo.dbPassword);\r",
                    "\t\t\t\tdbSchema.setValue(dbDict.SchemaName);\r",
                    "\t\t\t}\r",
                    "\t\t}\r",
                    "\t}\r",
                    "    else {\r",
                    "        //new application setting default value\r",
                    "\t\tdbServer.setValue('localhost');\r",
                    "\t\tdbServer.show();\r",
                    "\t\tdbInstance.setValue('default');\r",
                    "\t\tdbInstance.show();\r",
                    "\t\tdbSchema.setValue('dbo');\r",
                    "\t\tportNumber.setValue('1433');\r",
                    "\t\tportNumber.hide();\r",
                    "\r",
                    "\t\tdbName.setValue('');\r",
                    "\t\tdbName.clearInvalid();\r",
                    "\t\tdbName.show();\r",
                    "\t\tuserName.setValue('');\r",
                    "\t\tpassword.setValue('');\r",
                    "\t\tdbProvider.setValue('MsSql2008');\r",
                    "\t\thost.setValue('');\r",
                    "\t\thost.hide();\r",
                    "\t\tserviceName.hide();\r",
                    "    \r",
                    "    oraclecontainer.hide();  \r",
                    "    //sid.hide();\r",
                    "    //radioGroup.hide();\r",
                    "      \r",
                    "\t\tuserName.clearInvalid();\r",
                    "\t\tpassword.clearInvalid();\r",
                    "\t}\r",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|targetType": "Ext.button.Button",
                "designer|controlQuery": " button[action=resetconnectionform]"
            },
            "designerId": "4b1e3c3c-0707-43b1-b8ae-d6ac177626e5"
        }
    ]
}