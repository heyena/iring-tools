<?xml version="1.0"?>
	<!-- note that variables that can legally be provided as part of a T-SQL query must start with @
		additionally, these queries allow non-legal string replacement variables that start with @!~; these
		string replacements must take place before the query is sent to SQL Server or the query will fail
	-->
<configuration>

	<projectVariables>
	
	<!--
		there may be assignment lines with no names; these should be ignored. 
		The assignment should also be ignored if the value attribute is set to "!NoValue"
	-->
		<assignment query="" name="" value="" />
		
		<!-- Note: @ProjectDBName is handled as a special case because it represents the Object name of the database containing the
			data to be pushed to staging; it can be provided here, in which case it will override the value provided by the
			project connection information in the Project SPPID.config file. If the value is NOT provided here, this
			variable will automatically be added to the values collection with the connection database name as the value
		
		<assignment query="!All" name="@ProjectDBName" value="!NoValue" /> 
		-->
		<assignment query="SPPIDPanels" name="@InstrumentComponentType" value="!NoValue" />
		<assignment query="" name="" value="" />
		<assignment query="" name="" value="" />
	</projectVariables>
	
	<projectReplacements>
		<assignment query="!All" name="!@~IncludeStockpileJoin" value="Left" />
	</projectReplacements>
	
	<query name="!Template" stagingDestinationName="">
		<description>
		</description>
		<variables>
			<!-- a textReplacement is a string that MUST be replaced via a string replacement before the query 
				can be sent to the server; without this, the query will not be valid. 
				All textVariables should start with "!@~" 
				a declaration is a SQL variable for which the value should be provided before the query can be sent to
				the server. A default value may make this unnecessary. 
				All sql declarations will appear bofore the query as part of a DECLARE statement, and then 
				again in a SET statement where the sql variable's value is set. SQL Variables MUST begin with "@"
				Note that the 'value' attribute for both textReplacement and declaration are for providing a default
				value. This may or may not be replaced later with another value when the query is being built by the 
				query build function
			-->
			<textReplacement name="" value="" datatype="" />
			
			<!-- Optional, when set to true, indicates that all instances of this variable are within optional query clauses
					this means that, if the parameter is not supplied, the clause (or statement within the clause) will not be 
					part of the query. This is usually set to indicate optional where clause conditions, making the query as open 
					as possible. All associated clauses must also be marked "optional='yes'" in order for the statement to be
					removed from the query
			-->
			<declaration name="" value="" datatype="" optional="true" />
		</variables>
		<selection value="distinct" />
		<selection value="top 30%" />
		<fields>
			<!-- source should generally reference the source alias if there is one; otherwise the source name -->
			<field source="" name="" datatype="" alias="" />
			<field source="" name="" datatype="" alias="" />
			<field source="" name="" datatype="" alias="" />
			<field source="" name="" datatype="" alias="" />
			<field source="" name="" datatype="" alias="" />
			<field source="" name="" datatype="" alias="" />
		</fields>
		<sources>
			<!-- note that for SPPID, schema is NOT the actual schema name because this may change from project to project.
				instead, it denotes the SPPID schema type name. From this, the true schema name can be derived from the SPPID
				Site DB
			-->
			<source name="" 	schema="" 	joinType=""		alias="">
				<!-- the first source will have an empty relation -->
				<relation leftSource="" leftField="" rightSource="" rightField="" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="" 	schema="" 	joinType="Inner"		alias="">
				<!-- joinToText indicates that the right field name should not be concatenated with the rightSource; instead, it will be single quoted as a constant
					by default the value is left blank, which is the same as 'false'. The first relation clause must always have an empty conjunction -->
				<relation conjunction="" leftSource="" leftField="" operator="=" 
					rightSource="" rightField="" 
					joinToText="" />
				<relation conjunction="and" leftSource="" leftField="" operator="=" 
					rightSource="" rightField="" 
					joinToText="" />					
			</source>
			<source name="" 	schema="" 	joinType="Left"		alias="">
				<relation leftSource="" leftField="" rightSource="" rightField="" 
					joinToText="" operator="=" conjunction="" />
				<relation leftSource="" leftField="" rightSource="" rightField="mud" 
					joinToText="True" operator="=" conjunction="and" />
			</source>
			
		</sources>
		<filters>
			<!-- the first filter will always have an empty conjunction. all others must have a conjunction -->
			<filter  preParenCount="0" source="" fieldName="" operator="=" filterValue="" postParenCount="0" conjunction="" />
			<filter  preParenCount="0" source="" fieldName="" operator="=" filterValue="" postParenCount="0" conjunction="and" />		
		</filters>
		<sorts>
			<!-- sortDirection should be left blank, or set to DESC if desired -->
			<sort source="" fieldName="" sortDirection="" />
		</sorts>
	</query>
	
	<query name="!SiteData" stagingDestinationName="">
		<description>
			The SiteData query gives schema mapping information for every project in the site
		</description>
		<variables>
			<declaration name="@ProjectDBName" value="" datatype="varchar(240)" />
		</variables>
		<fields>
			<field source="DB" name="Data_base" 			datatype="" 								alias="" />
			<field source="DB" name="DBServer" 				datatype="" 								alias="" />
			<field source="RI" name="Path" 					datatype="" 								alias="" />
			<field source="DB" name="SP_Schema_Type" 		datatype="" 								alias="" />
			<field source="DB" name="Username" 				datatype="" 								alias="" />
			<field source="RI" name="Description" 			datatype="" 								alias="" />
			<field source="RI" name="PlantGroupTypeName" 	datatype="" 								alias="" />
			<field source="RI" name="DateCreated" 			datatype="" 								alias="" />
			<field source="DB" name="SP_ID" 				datatype="" 								alias="" />
			<field source="DB" name="SP_RootItemID" 		datatype="" 								alias="" />
		</fields>
		<sources>
			<source name="T_DB_Data" 	schema="SITE" 	joinType=""							alias="DB">
				<relation leftSource="" leftField="" rightSource="" rightField="" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_RootItem" 	schema="SITE" 	joinType="Inner"					alias="RI">
				<relation conjunction="" leftSource="DB" leftField="SP_RootItemID" operator="=" 
					rightSource="RI" rightField="SP_ID" 
					joinToText="" />
			</source>
		</sources>
		<filters>
			<!-- the first filter will always have an empty conjunction. all others must have a conjunction 
				if a filters sections contains one or more optional filters, optional filters for which 
				a valid variabale has not been suppolied will be removed, the operator will be ignored and
				the parentheses closed (after the last valid filter) to make the query valid. If the filters
				section contains no filters due to lack of supplied variables, then the Where clause will 
				be removed.
			-->
			<filter  preParenCount="0" source="DB" fieldName="Data_Base" operator="=" 
				filterValue="@ProjectDBName" postParenCount="0" conjunction="" optional="true" />
		</filters>
		<sorts>
		</sorts>
	</query>
  
	<query name="SPPIDPanels" stagingDestinationName="Panels">
		<description>
		</description>
		<variables>
			<textReplacement name="!@~IncludeStockpileJoin" value="false" datatype="boolean" />
			<declaration name="@InstrumentComponentType" value="" datatype="nvarchar" optional="true" />
		</variables>
		<selection value="distinct" />
		<fields>
			<field source="PlI" 	name="ItemTag" 						alias=""							datatype="" />
			<field source="PlI" 	name="SupplyBy" 					alias=""							datatype="" />
			<field source="PlI" 	name="SP_ID" 						alias=""							datatype="" />
			<field source="PlI" 	name="SP_PlantGroupID" 				alias=""							datatype="" />
			<field source="PlI" 	name="SP_PartOfID" 					alias=""							datatype="" />
			<field source="PlI" 	name="Name" 						alias="PlantItemName"				datatype="" />
			
			<field source="PG" 		name="Name" 						alias="PidUnitName"					datatype="" />
			<field source="PG" 		name="Description" 					alias="PidUnitDescription"			datatype="" />
			
			<field source="Dr" 		name="DrawingNumber" 				alias=""							datatype="" />
			<field source="Dr" 		name="Name" 						alias="DrawingName"					datatype="" />
			<field source="" 		name="" 							alias="Title"						datatype="" 
				expression="REPLACE(REPLACE(REPLACE(Dr.Title,CHAR(9),' '),CHAR(10),' '),CHAR(13),' ')" />
			<field source="Dr" 		name="Description" 					alias="DrawingDescription"			datatype="" />
			
			<field source="Inst" 	name="TagSequenceNo" 				alias=""							datatype="" />
			<field source="Inst" 	name="TagSuffix" 					alias=""							datatype="" />
			<field source="Inst" 	name="LoopTagSuffix" 				alias=""							datatype="" />
			<field source="Inst" 	name="InstrumentClass" 				alias=""							datatype="" />
			<field source="Inst" 	name="InstrumentType" 				alias=""							datatype="" />
			<field source="Inst" 	name="PipingMaterialsClass" 		alias=""							datatype="" />
			<field source="Inst" 	name="SP_PipeRunID" 				alias=""							datatype="" />
			<field source="Inst" 	name="SP_SignalRunID" 				alias=""							datatype="" />
			<field source="Inst" 	name="MeasuredVariableCode" 		alias="UnitProcessNo"				datatype="" />
			<field source="Inst" 	name="InstrumentTypeModifier" 		alias="TagPrefix"					datatype="" />
			
			<field source="IC" 		name="NominalDiameter" 				alias=""							datatype="" />
			<field source="IC" 		name="ActuatorType" 				alias=""							datatype="" />
			
			<field source="Cl" 		name="codeList_number" 				alias=""							datatype="" />
			<field source="Cl"		name="codelist_text" 				alias=""							datatype="" />
			<field source="Cl"		name="codelist_index" 				alias=""							datatype="" />
			<field source="Cl" 		name="codelist_constraint" 			alias=""							datatype="" />
			
			<field source="En" 		name="Name" 						alias="EnumerationName"				datatype="" />
			<field source="IFM" 	name="FailureAction" 				alias=""							datatype="" />
			<field source="Rep" 	name="InStockPile" 					alias=""							datatype="" />
			<field source="U" 		name="UnitCode" 					alias="PidUnitCode"					datatype="" />
		</fields>
		<sources>
			<!-- note that for SPPID, schema is NOT the actual schema name because this may change from project to project.
				instead, it denotes the SPPID schema type name. From this, the true schema name can be derived from the SPPID
				Site DB
			-->
			<source name="T_PlantGroup" 	schema="SPAPLANT"					joinType=""					 	alias="PG">
			</source> 
			<source name="T_Drawing"		schema="SPPID"    					joinType="Inner" 				alias="Dr">
				<relation leftSource="PG" leftField="SP_ID" rightSource="Dr" rightField="SP_PlantGroupID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_Representation"	schema="SPPID"						joinType="Inner" 				alias="Rep">
				<relation leftSource="Dr" leftField="SP_ID" rightSource="Rep" rightField="SP_DrawingID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_Unit"			schema="SPAPLANT"					joinType="!@~IncludeStockpilejoin" 	alias="U" >
				<relation leftSource="PG" leftField="SP_ID" rightSource="U" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_PlantItem"		schema="SPPID"    					joinType="Inner" 				alias="PlI">
				<relation leftSource="PlI" leftField="SP_PlantGroupID" rightSource="U" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
				<relation leftSource="PlI" leftField="SP_ID" rightSource="Rep" rightField="SP_ModelItemID" 
					joinToText="" operator="=" conjunction="and" />
				<relation leftSource="PlI" leftField="SP_PlantGroupID" rightSource="PG" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="and" />
			</source>
			<source name="T_Instrument" 	schema="SPPID"    					joinType="Inner" 				alias="Inst">
				<relation leftSource="Inst" leftField="SP_ID" rightSource="PlI" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_InlineComp"		schema="SPPID"    					joinType="Inner" 				alias="IC">
				<relation leftSource="IC" leftField="SP_InstrumentID" rightSource="Inst" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_InstrFailMode"	schema="SPPID"    					joinType="Inner" 				alias="IFM">
				<relation leftSource="IFM" leftField="SP_InstrumentID" rightSource="Inst" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="Codelists"		schema="SPPIDDATA_DICTIONARY"    	joinType="Inner" 				alias="Cl">
				<relation leftSource="Cl" leftField="codelist_index" rightSource="Inst" rightField="InstrumentType" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="Enumerations"		schema="SPPIDDATA_DICTIONARY"    	joinType="Inner" 				alias="En">
				<relation leftSource="En" leftField="Id" rightSource="Cl" rightField="codelist_number" 
					joinToText="" operator="=" conjunction="" />
			</source>
		</sources>
		<filters>
			<filter  preParenCount="0" source="En" fieldName="Name" operator="=" filterValue="@InstrumentComponentType" postParenCount="0" conjunction="" />
		</filters>
		<sorts>
			<sort source="" fieldName="" sortDirection="" />
		</sorts>
	</query>
	
	<query name="SPPIDEquipment" stagingDestinationName="Equipment">
		<description>
		</description>
		<variables>
			<textReplacement name="!@~IncludeStockpileJoin" value="false" datatype="boolean" />
			<declaration name="@EquipmentClassName" value="" datatype="nvarchar" optional="true" />
			<declaration name="@PlantGroupID" value="" datatype="int" optional="true" />
		</variables>
		<selection value="distinct" />
		<fields>
			<field source="PlI" 	name="ItemTag" 						alias=""							datatype="" />
			<field source="PlI" 	name="SupplyBy" 					alias=""							datatype="" />
			<field source="PlI" 	name="SP_ID" 						alias=""							datatype="" />
			<field source="PlI" 	name="SP_PlantGroupID" 				alias=""							datatype="" />
			<field source="PlI" 	name="SP_PartOfID" 					alias=""							datatype="" />
			<field source="PlI" 	name="aabbcc_code" 					alias=""							datatype="" />
			<field source="PlI" 	name="ConstructionStatus" 			alias=""							datatype="" />
			<field source="PlI" 	name="Name" 						alias="PlantItemName"				datatype="" />
			
			<field source="PG" 		name="Name" 						alias="PidUnitName"					datatype="" />
			<field source="PG" 		name="Description" 					alias="PidUnitDescription"			datatype="" />
			
			<field source="Dr" 		name="DrawingNumber" 				alias=""							datatype="" />
			<field source="Dr" 		name="Name" 						alias="DrawingName"					datatype="" />
			<field source="" 		name="" 							alias="Title"						datatype="" 
				expression="REPLACE(REPLACE(REPLACE(Dr.Title,CHAR(9),' '),CHAR(10),' '),CHAR(13),' ')" />
			<field source="Dr" 		name="Description" 					alias="DrawingDescription"			datatype="" />
			
			<field source="Eq" 		name="TagPrefix"	 				alias=""							datatype="" />
			<field source="Eq" 		name="TagSequenceNo" 				alias=""							datatype="" />
			<field source="Eq" 		name="TagSuffix" 					alias=""							datatype="" />
			<field source="Eq" 		name="Class"		 				alias=""							datatype="" />
			<field source="Eq" 		name="EquipmentSubClass"			alias=""							datatype="" />
			<field source="Eq" 		name="EquipmentType" 				alias=""							datatype="" />
			<field source="Eq" 		name="CoatingReqmts"			 		alias="CoatingRequirements"			datatype="" />
			
			<field source="En" 		name="Name" 						alias="EnumerationName"				datatype="" />
			<field source="En" 		name="Description" 					alias="EnumerationDescription"		datatype="" />
			
			<field source="Cl" 		name="codeList_number" 				alias=""							datatype="" />
			<field source="Cl"		name="codelist_text" 				alias=""							datatype="" />
			<field source="Cl"		name="codelist_index" 				alias=""							datatype="" />
			<field source="Cl" 		name="codelist_constraint" 			alias=""							datatype="" />
			
			<field source="Rep" 	name="InStockPile" 					alias=""							datatype="" />
			<field source="U" 		name="UnitCode" 					alias="PidUnitCode"					datatype="" />
		</fields>
		<sources>
			<!-- note that for SPPID, schema is NOT the actual schema name because this may change from project to project.
				instead, it denotes the SPPID schema type name. From this, the true schema name can be derived from the SPPID
				Site DB
			-->
			<source name="T_PlantGroup" 	schema="SPAPLANT"					joinType=""					 	alias="PG">
			</source> 
			<source name="T_Drawing"		schema="SPPID"    					joinType="Inner" 				alias="Dr">
				<relation leftSource="PG" leftField="SP_ID" rightSource="Dr" rightField="SP_PlantGroupID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_Representation"	schema="SPPID"						joinType="Inner" 				alias="Rep">
				<relation leftSource="Dr" leftField="SP_ID" rightSource="Rep" rightField="SP_DrawingID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_Unit"			schema="SPAPLANT"					joinType="!@~IncludeStockpilejoin" 	alias="U" >
				<relation leftSource="PG" leftField="SP_ID" rightSource="U" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_PlantItem"		schema="SPPID"    					joinType="Inner" 				alias="PlI">
				<relation leftSource="PlI" leftField="SP_PlantGroupID" rightSource="U" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
				<relation leftSource="PlI" leftField="SP_ID" rightSource="Rep" rightField="SP_ModelItemID" 
					joinToText="" operator="=" conjunction="and" />
				<relation leftSource="PlI" leftField="SP_PlantGroupID" rightSource="PG" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="and" />
			</source>
			<source name="T_Equipment" 		schema="SPPID"    					joinType="Inner" 				alias="Eq">
				<relation leftSource="Eq" leftField="SP_ID" rightSource="PlI" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="Codelists"		schema="SPPIDDATA_DICTIONARY"    	joinType="Inner" 				alias="Cl">
				<relation leftSource="Cl" leftField="codelist_index" rightSource="Eq" rightField="Class" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="Enumerations"		schema="SPPIDDATA_DICTIONARY"    	joinType="Inner" 				alias="En">
				<relation leftSource="En" leftField="Id" rightSource="Cl" rightField="codelist_number" 
					joinToText="" operator="=" conjunction="" />
			</source>
		</sources>
		<filters>
			<filter  preParenCount="0" source="En" fieldName="Name" operator="=" filterValue="@EquipmentClassName" postParenCount="0" conjunction="" optional="true" />
			<filter  preParenCount="0" source="PlI" fieldName="SP_PlantGroupID" operator="=" filterValue="@PlantGroupID" postParenCount="0" conjunction="and" optional="true" />
		</filters>
		<sorts>
			<sort source="" fieldName="" sortDirection="" />
		</sorts>
	</query>
 
	<query name="SPPIDInstrument" stagingDestinationName="Instruments">
		<description>
		</description>
		<variables>
			<textReplacement name="!@~IncludeStockpileJoin" value="false" datatype="boolean" />
			<declaration name="@EquipmentClassName" value="" datatype="nvarchar" optional="true" />
			<declaration name="@PlantGroupID" value="" datatype="int" optional="true" />
			<declaration name="@UnitCode" value="" datatype="nvarchar(22)" optional="true" />
			<declaration name="@DrawingNumber" value="" datatype="nvarchar(80)" optional="true" />
		</variables>
		<selection value="distinct" />
		<fields>
			<field source="PlI" 	name="ItemTag" 						alias=""							datatype="" />
			<field source="PlI" 	name="SupplyBy" 					alias=""							datatype="" />
			<field source="PlI" 	name="SP_ID" 						alias=""							datatype="" />
			<field source="PlI" 	name="SP_PlantGroupID" 				alias=""							datatype="" />
			<field source="PlI" 	name="SP_PartOfID" 					alias=""							datatype="" />
			<field source="PlI" 	name="aabbcc_code" 					alias=""							datatype="" />
			<field source="PlI" 	name="ConstructionStatus" 			alias=""							datatype="" />
			<field source="PlI" 	name="Name" 						alias="PlantItemName"				datatype="" />
			
			<field source="PG" 		name="Name" 						alias="PidUnitName"					datatype="" />
			<field source="PG" 		name="Description" 					alias="PidUnitDescription"			datatype="" />
			
			<field source="Dr" 		name="DrawingNumber" 				alias=""							datatype="" />
			<field source="Dr" 		name="Name" 						alias="DrawingName"					datatype="" />
			<field source="" 		name="" 							alias="Title"						datatype="" 
				expression="REPLACE(REPLACE(REPLACE(Dr.Title,CHAR(9),' '),CHAR(10),' '),CHAR(13),' ')" />
			<field source="Dr" 		name="Description" 					alias="DrawingDescription"			datatype="" />
			
			<field source="Inst" 	name="TagSequenceNo" 				alias=""							datatype="" />
			<field source="Inst" 	name="TagSuffix" 					alias=""							datatype="" />
			<field source="Inst" 	name="LoopTagSuffix" 				alias=""							datatype="" />
			<field source="Inst" 	name="InstrumentClass" 				alias=""							datatype="" />
			<field source="Inst" 	name="PipingMaterialsClass"			alias=""							datatype="" />
			<field source="Inst" 	name="InstrumentType" 				alias=""							datatype="" />
			<field source="Inst" 	name="SP_PipeRunID" 				alias=""							datatype="" />
			<field source="Inst" 	name="SP_SignalRunID" 				alias=""							datatype="" />
			<field source="Inst" 	name="IsInline"		 				alias=""							datatype="" />
			<field source="Inst" 	name="MeasuredVariableCode"			alias="UnitProcessNo"				datatype="" />
			<field source="Inst" 	name="InstrumentTypeModifier"		alias="TagPrefix"					datatype="" />

			<field source="En" 		name="Name" 						alias="EnumerationName"				datatype="" />
			<field source="En" 		name="Description" 					alias="EnumerationDescription"		datatype="" />
			
			<field source="IC" 		name="NominalDiameter" 				alias=""							datatype="" />
			<field source="IC" 		name="CoatingReqmts" 				alias="CoatingRequirements"			datatype="" />
			
			<field source="Cl" 		name="codeList_number" 				alias=""							datatype="" />
			<field source="Cl"		name="codelist_text" 				alias=""							datatype="" />
			<field source="Cl"		name="codelist_index" 				alias=""							datatype="" />
			<field source="Cl" 		name="codelist_constraint" 			alias=""							datatype="" />
			
			<field source="PR" 		name="OperFluidCode" 				alias=""							datatype="" />
			
			<field source="Rep" 	name="InStockPile" 					alias=""							datatype="" />
			<field source="U" 		name="UnitCode" 					alias="PidUnitCode"					datatype="" />
		</fields>
		<sources>
			<!-- note that for SPPID, schema is NOT the actual schema name because this may change from project to project.
				instead, it denotes the SPPID schema type name. From this, the true schema name can be derived from the SPPID
				Site DB
			-->
			<source name="T_PlantGroup" 	schema="SPAPLANT"					joinType=""					 	alias="PG">
			</source> 
			<source name="T_Drawing"		schema="SPPID"    					joinType="Inner" 				alias="Dr">
				<relation leftSource="PG" leftField="SP_ID" rightSource="Dr" rightField="SP_PlantGroupID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_Representation"	schema="SPPID"						joinType="Inner" 				alias="Rep">
				<relation leftSource="Dr" leftField="SP_ID" rightSource="Rep" rightField="SP_DrawingID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_Unit"			schema="SPAPLANT"					joinType="!@~IncludeStockpilejoin" 	alias="U" >
				<relation leftSource="PG" leftField="SP_ID" rightSource="U" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_PlantItem"		schema="SPPID"    					joinType="Inner" 				alias="PlI">
				<relation leftSource="PlI" leftField="SP_PlantGroupID" rightSource="U" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
				<relation leftSource="PlI" leftField="SP_ID" rightSource="Rep" rightField="SP_ModelItemID" 
					joinToText="" operator="=" conjunction="and" />
				<relation leftSource="PlI" leftField="SP_PlantGroupID" rightSource="PG" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="and" />
			</source>
			<source name="T_Instrument" 		schema="SPPID"    					joinType="Inner" 				alias="Inst">
				<relation leftSource="Inst" leftField="SP_ID" rightSource="PlI" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="Codelists"		schema="SPPIDDATA_DICTIONARY"    	joinType="Inner" 				alias="Cl">
				<relation leftSource="Cl" leftField="codelist_index" rightSource="Inst" rightField="InstrumentClass" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="Enumerations"		schema="SPPIDDATA_DICTIONARY"    	joinType="Inner" 				alias="En">
				<relation leftSource="En" leftField="Id" rightSource="Cl" rightField="codelist_number" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_InlineComp"		schema="SPPID"    					joinType="Inner" 				alias="IC">
				<relation leftSource="IC" leftField="SP_InstrumentID" rightSource="Inst" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_PipeRun"		schema="SPPID"    					joinType="Inner" 				alias="PR">
				<relation leftSource="PR" leftField="SP_ID" rightSource="IC" rightField="SP_PipeRunID" 
					joinToText="" operator="=" conjunction="" />
			</source>
		</sources>
		<filters>
			<filter  preParenCount="0" source="En" fieldName="Name" operator="=" filterValue="@EquipmentClassName" postParenCount="0" conjunction="" optional="true" />
			<filter  preParenCount="0" source="PlI" fieldName="SP_PlantGroupID" operator="=" filterValue="@PlantGroupID" postParenCount="0" conjunction="and" optional="true" />
			<filter  preParenCount="0" source="U" fieldName="UnitCode" operator="=" filterValue="@UnitCode" postParenCount="0" conjunction="and" optional="true" />
			<filter  preParenCount="0" source="Dr" fieldName="DrawingNumber" operator="=" filterValue="@DrawingNumber" postParenCount="0" conjunction="and" optional="true" />
		</filters>
		<sorts>
		</sorts>
	</query> 
	
	<query name="SPPIDPipingComponents" stagingDestinationName="PipingComponents">
		<description>
		</description>
		<variables>
			<textReplacement name="!@~IncludeStockpileJoin" value="false" datatype="boolean" />
			--<declaration name="@EquipmentClassName" value="" datatype="nvarchar" optional="true" />
			<declaration name="@PlantGroupID" value="" datatype="int" optional="true" />
			<declaration name="@UnitCode" value="" datatype="nvarchar(22)" optional="true" />
			<declaration name="@DrawingNumber" value="" datatype="nvarchar(80)" optional="true" />
		</variables>
		<selection value="distinct" />
		<fields>
			<field source="PlI" 	name="ItemTag" 						alias=""							datatype="" />
			<field source="PlI" 	name="SupplyBy" 					alias=""							datatype="" />
			<field source="PlI" 	name="SP_ID" 						alias=""							datatype="" />
			<field source="PlI" 	name="SP_PlantGroupID" 				alias=""							datatype="" />
			<field source="PlI" 	name="SP_PartOfID" 					alias=""							datatype="" />
			<field source="PlI" 	name="aabbcc_code" 					alias=""							datatype="" />
			<field source="PlI" 	name="ConstructionStatus" 			alias=""							datatype="" />
			<field source="PlI" 	name="Name" 						alias="PlantItemName"				datatype="" />
			
			<field source="PG" 		name="Name" 						alias="PidUnitName"					datatype="" />
			<field source="PG" 		name="Description" 					alias="PidUnitDescription"			datatype="" />
			
			<field source="Dr" 		name="DrawingNumber" 				alias=""							datatype="" />
			<field source="Dr" 		name="Name" 						alias="DrawingName"					datatype="" />
			<field source="" 		name="" 							alias="Title"						datatype="" 
				expression="REPLACE(REPLACE(REPLACE(Dr.Title,CHAR(9),' '),CHAR(10),' '),CHAR(13),' ')" />
			<field source="Dr" 		name="Description" 					alias="DrawingDescription"			datatype="" />
			
			<field source="Inst" 	name="TagSequenceNo" 				alias=""							datatype="" />
			<field source="Inst" 	name="TagSuffix" 					alias=""							datatype="" />
			<field source="Inst" 	name="LoopTagSuffix" 				alias=""							datatype="" />
			<field source="Inst" 	name="InstrumentClass" 				alias=""							datatype="" />
			<field source="Inst" 	name="PipingMaterialsClass"			alias=""							datatype="" />
			<field source="Inst" 	name="InstrumentType" 				alias=""							datatype="" />
			<field source="Inst" 	name="SP_PipeRunID" 				alias=""							datatype="" />
			<field source="Inst" 	name="SP_SignalRunID" 				alias=""							datatype="" />
			<field source="Inst" 	name="IsInline"		 				alias=""							datatype="" />
			<field source="Inst" 	name="MeasuredVariableCode"			alias="UnitProcessNo"				datatype="" />
			<field source="Inst" 	name="InstrumentTypeModifier"		alias="TagPrefix"					datatype="" />

			<field source="En" 		name="Name" 						alias="EnumerationName"				datatype="" />
			<field source="En" 		name="Description" 					alias="EnumerationDescription"		datatype="" />
			
			<field source="IC" 		name="NominalDiameter" 				alias=""							datatype="" />
			<field source="IC" 		name="CoatingReqmts" 				alias="CoatingRequirements"			datatype="" />
			
			<field source="Cl" 		name="codeList_number" 				alias=""							datatype="" />
			<field source="Cl"		name="codelist_text" 				alias=""							datatype="" />
			<field source="Cl"		name="codelist_index" 				alias=""							datatype="" />
			<field source="Cl" 		name="codelist_constraint" 			alias=""							datatype="" />
			
			<field source="Rep" 	name="InStockPile" 					alias=""							datatype="" />
			<field source="U" 		name="UnitCode" 					alias="PidUnitCode"					datatype="" />
		</fields>
		<sources>
			<!-- note that for SPPID, schema is NOT the actual schema name because this may change from project to project.
				instead, it denotes the SPPID schema type name. From this, the true schema name can be derived from the SPPID
				Site DB
			-->
			<source name="T_PlantGroup" 	schema="SPAPLANT"					joinType=""					 	alias="PG">
			</source> 
			<source name="T_Drawing"		schema="SPPID"    					joinType="Inner" 				alias="Dr">
				<relation leftSource="PG" leftField="SP_ID" rightSource="Dr" rightField="SP_PlantGroupID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_Representation"	schema="SPPID"						joinType="Inner" 				alias="Rep">
				<relation leftSource="Dr" leftField="SP_ID" rightSource="Rep" rightField="SP_DrawingID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_Unit"			schema="SPAPLANT"					joinType="!@~IncludeStockpilejoin" 	alias="U" >
				<relation leftSource="PG" leftField="SP_ID" rightSource="U" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_PlantItem"		schema="SPPID"    					joinType="Inner" 				alias="PlI">
				<relation leftSource="PlI" leftField="SP_PlantGroupID" rightSource="U" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
				<relation leftSource="PlI" leftField="SP_ID" rightSource="Rep" rightField="SP_ModelItemID" 
					joinToText="" operator="=" conjunction="and" />
				<relation leftSource="PlI" leftField="SP_PlantGroupID" rightSource="PG" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="and" />
			</source>
			<source name="T_Instrument" 		schema="SPPID"    					joinType="Inner" 				alias="Inst">
				<relation leftSource="Inst" leftField="SP_ID" rightSource="PlI" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="Codelists"		schema="SPPIDDATA_DICTIONARY"    	joinType="Inner" 				alias="Cl">
				<relation leftSource="Cl" leftField="codelist_index" rightSource="Inst" rightField="InstrumentClass" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="Enumerations"		schema="SPPIDDATA_DICTIONARY"    	joinType="Inner" 				alias="En">
				<relation leftSource="En" leftField="Id" rightSource="Cl" rightField="codelist_number" 
					joinToText="" operator="=" conjunction="" />
			</source>
			<source name="T_InlineComp"		schema="SPPID"    					joinType="Inner" 				alias="IC">
				<relation leftSource="IC" leftField="SP_InstrumentID" rightSource="Inst" rightField="SP_ID" 
					joinToText="" operator="=" conjunction="" />
			</source>
		</sources>
		<filters>
			<filter  preParenCount="0" source="En" fieldName="Name" operator="=" filterValue="@EquipmentClassName" postParenCount="0" conjunction="" optional="true" />
			<filter  preParenCount="0" source="PlI" fieldName="SP_PlantGroupID" operator="=" filterValue="@PlantGroupID" postParenCount="0" conjunction="and" optional="true" />
			<filter  preParenCount="0" source="U" fieldName="UnitCode" operator="=" filterValue="@UnitCode" postParenCount="0" conjunction="and" optional="true" />
			<filter  preParenCount="0" source="Dr" fieldName="DrawingNumber" operator="=" filterValue="@DrawingNumber" postParenCount="0" conjunction="and" optional="true" />
		</filters>
		<sorts>
		</sorts>
	</query>
</configuration>