/*
* File: Scripts/AM/view/directory/ApplicationForm.js
*
* This file was generated by Sencha Architect version 2.2.2.
* http://www.sencha.com/products/architect/
*
* This file requires use of the Ext JS 4.1.x library, under independent license.
* License of Sencha Architect does not include license for Ext JS 4.1.x. For more
* details see http://www.sencha.com/license or contact license@sencha.com.
*
* This file will be auto-generated each and everytime you save your project.
*
* Do NOT hand edit this file.
*/
Ext.define('AM.view.directory.NewJobForm', {
    extend: 'Ext.form.Panel',
    alias: 'widget.newjobform',
    border: false,
    bodyStyle: 'padding:10px 5px 0',
    url: 'directory/saveSchedularData',
    initComponent: function () {
        var me = this;

        me.initialConfig = Ext.apply({
            url: 'directory/saveSchedularData'
        }, me.initialConfig);

        var tempStore = Ext.create('Ext.data.Store', {
            fields: ['display'],
            listeners: {
                'load': function () {
                    var arr = Ext.getStore('DirectoryTreeStore').tree.root.childNodes;
                    Ext.each(arr, function (item, index) {
                        tempStore.insert(index, {
                            display: item.data.property["Display Name"]
                        });

                    })
                }

            }


        });


        var weekDaysStore = Ext.create('Ext.data.Store', {
            fields: ['weekdays'],
            data: [
        { "weekdays": "Monday" },
        { "weekdays": "Tuesday" },
        { "weekdays": "Wednesday" },
        { "weekdays": "Thursday" },
        { "weekdays": "Friday" },
        { "weekdays": "Saturday" },
        { "weekdays": "Sunday" }

        ]

        });


        Ext.applyIf(me, {

            items: [{
                xtype: 'fieldset',
                title: 'Job Info',
                layout: 'anchor',
                defaults: {
                    anchor: '100%'
                },
                items: [

                    {
                        xtype: 'container',
                        layout: 'hbox',
                        margin: '15 0 5 0',
                        items: [{
                            xtype: 'label',
                            name: 'cont',
                            text: 'Context',
                            margin: '4 61 0 0 ',
                            allowBlank: false
                        }, {

                            xtype: 'combobox',
                            itemId: 'scopecombo',
                            margin: '4 40 0 0 ',
                            labelWidth: 110,
                            name: 'displayName',
                            editable: false



                        }, {
                            xtype: 'label',
                            name: 'exch',
                            text: 'App',
                            margin: '4 40 0 0 ',
                            allowBlank: false
                        }, {
                            xtype: 'combobox',
                            name: 'applications',
                            itemId: 'appcombo',
                            store: 'apptempStore',
                            //forceSelection: true,
                            //triggerAction: 'all',
                            displayField: 'display',
                            valueField: 'display'

                        }]
                    }, {
                        xtype: 'container',
                        layout: 'hbox',
                        margin: '17 0 15 0',
                        items: [{
                            xtype: 'label',
                            name: 'exchurl',
                            text: 'DataObject',
                            margin: '4 42 0 0 ',
                            allowBlank: false
                        }, {
                            labelWidth: 110,
                            xtype: 'combobox',
                            name: 'dataobj',
                            allowBlank: false
                        }]
                    }
                ]
            }, {
                xtype: 'fieldset',
                title: '<b>Occurance</b>',
                border: 0,
                margin: '15 0 25 0 ',
                layout: 'anchor',
                defaults: {
                    anchor: '100%'
                },
                items: [{
                    xtype: 'container',
                    layout: 'hbox',
                    defaultType: 'radiofield',
                    margin: '10 0 0 0',
                    items: [{
                        //xtype: 'radio',
                        boxLabel: 'Daily',
                        inputValue: 'Daily',
                        name: 'occrad',
                        margin: '4 160 0 0 ',
                        allowBlank: false
                    },
                   {
                   //xtype: 'radio',
                   boxLabel: 'Weekly',
                   inputValue: 'Weekly',
                   name: 'occrad',
                   margin: '4 170 0 0 ',
                   allowBlank: false
               }, {
                   //xtype: 'radio',
                   boxLabel: 'Monthly',
                   inputValue: 'Monthly',
                   name: 'occrad',
                   margin: '4 40 0 0 ',
                   allowBlank: false
               }
                  ]
                }]

            }, {
                xtype: 'fieldset',
                border: 0,
                layout: 'anchor',
                defaults: {
                    anchor: '100%'
                },
                items: [{
                    xtype: 'container',
                    layout: 'hbox',
                    items: [
                         {
                             xtype: 'datefield',
                             fieldLabel: 'Start DateTime',
                             name: 'startDate',
                             minValue: (new Date()),
                             emptyText: 'Select Start Date',
                             width: 220,
                             anchor: '100%'
                         }, {
                             xtype: 'timefield',
                             name: 'startTime',
                             minValue: '00:00',
                             maxValue: '24:00',
                             width: 60,
                             format: 'H:i',
                             increment: 1,
                             emptyText: 'Time',
                             margin: '0 10 0 0',
                             anchor: '100%'
                         }, {
                             xtype: 'datefield',
                             fieldLabel: 'End DateTime',
                             name: 'endDate',
                             minValue: (new Date()),
                             emptyText: 'Select End Date',
                             labelWidth: 80,
                             width: 180,
                             disabled: false,
                             itemId: 'myEndDateCombo',
                             anchor: '100%'
                         }, {
                             xtype: 'timefield',
                             name: 'endTime',
                             minValue: '00:00',
                             maxValue: '24:00',
                             width: 60,
                             format: 'H:i',
                             increment: 1,
                             emptyText: 'Time',
                             disabled: false,
                             itemId: 'myEndTimeCombo',
                             anchor: '100%'
                         }]
                }]

            }, {
                xtype: 'fieldset',
                border: 0,
                layout: 'anchor',
                defaults: {
                    anchor: '100%'
                },
                items: [{
                    xtype: 'container',
                    layout: 'hbox',
                    margin: '10 0 5 0',
                    items: [
                     {
                         xtype: 'checkboxfield',
                         boxLabel: 'No End Date',
                         name: 'chkBox',
                         margin: '4 0 0 295',
                         checked:false,
                         //inputValue: '1',
                         listeners: {
                             change: function (cb, checked) {
                                 Ext.ComponentQuery.query('#myEndDateCombo')[0].setDisabled(checked);
                                 Ext.ComponentQuery.query('#myEndTimeCombo')[0].setDisabled(checked);
                             }
                         }
                        }]
                }]



            }],
            dockedItems: [{
                xtype: 'toolbar',
                dock: 'bottom',
                items: [{
                    xtype: 'tbfill'
                }, {
                    xtype: 'button',
                    //action: 'saveNewJob',
                    handler: function (button, event) {
                        me.onSave();
                    },
                    text: 'Save'
                }, {
                    xtype: 'button',
                    handler: function (button, event) {
                        this.up('.window').close();
                        //me.down('newScopeDir').getForm().reset();
                        //me.destroy();


                    },
                    text: 'Cancel'
                }]
            }]
        });

        me.callParent(arguments);
    },


    onSave: function () {
        var me = this;
        var win = me.up('window');
        var endpointName = me.getForm().findField('displayName').getValue();
        var appls = me.getForm().findField('applications').getValue();
        var dataobj = me.getForm().findField('dataobj').getValue();
        var startDate = me.getForm().findField('startDate').getValue();
        var startTime = me.getForm().findField('startTime').getValue();
        var endDate = me.getForm().findField('endDate').getValue();
        var endTime = me.getForm().findField('endTime').getValue();
//        var mondat = me.getForm().findField('monthdate').getValue();
//        var ouccarance = me.getForm().findField('monthdate').getValue();
        var ouccaradio = me.getForm().findField('occrad').getValue();

        me.getForm().submit({
            waitMsg: 'Saving Data...',
            success: function (response, request) {
                //Ext.example.msg('Notification', 'Newjob saved successfully!');
                win.fireEvent('save', me);

                Ext.Msg.alert('Success', action.result.msg);
            },
            failure: function (response, request) {
                Ext.Msg.alert('Failed', action.result.msg);
            }
        });
    }




});